import{_ as z,a4 as S,bw as M,r as d,ah as C,A as g,c as x,d as t,L as I,M as B,T as D,e as h,n as L,F as w,g as N,bx as T,by as $,j as p,U as A,V}from"./lss.js";const k=n=>(A("data-v-3eb6c625"),n=n(),V(),n),U=k(()=>t("div",{class:"flex flex-row justify-between w-full"},[t("p",{class:"font-medium text-base mr-auto my-2"}," Create Accounts by Uplaod excel file ")],-1)),j={class:"flex flex-col"},E={class:"relative"},W=k(()=>t("div",{class:"flex flex-col"},[t("div",{class:"text-lg font-medium"}," Drop files here or click to upload. "),t("span",null," File types: excel"),t("div",{class:"text-gray-600"}," Max size\uFF1A256MB ")],-1)),q={class:"relative mt-8"},J={__name:"Main",props:{showModal:Boolean},setup(n){const{cookies:y}=S(),c=M(),b=y.get("access_token");d(!1),new FormData;const l=d(!1),u=d(null);C("bind[dropzoneFile]",a=>{u.value=a,a.dropzone.on("addedfile",o=>{const s=a.dropzone.getAcceptedFiles();o.previewElement.querySelector("img").src=T,s.length>0&&a.dropzone.removeFile(s[0])})});const F=()=>{l.value=!0,m(!0)},m=a=>{const o=new WebSocket(`wss://liveshowseller.net/ws/admin/account/import/?token=${b}`);o.onmessage=s=>{var r,f,_;const e=JSON.parse(s.data);if(e.type==="room_data"&&a){const i=new FormData;i.append("file",u.value.dropzone.getAcceptedFiles()[0]),i.append("room_id",e.room_id),$(i,c.alert).then(v=>{console.log(v.data)}).catch(v=>{console.log("upload file error"),o.close(1e3)})}else e.type==="complete_data"?(console.log(e),c.notification.showMessageToast(`${(r=e.data)==null?void 0:r.detail}`),o.close(1e3)):e.type==="error_data"?(console.log(e),c.alert.showMessageToast(`error:${(f=e.data)==null?void 0:f.detail}`)):e.type==="success_data"&&(console.log(e),c.notification.showMessageToast(`success:${(_=e.data)==null?void 0:_.username}`))},o.onopen=s=>{console.log("socket connected")},o.onclose=s=>{s.code!=1e3&&m(!1),console.error("socket closed"),l.value=!1},o.onerror=function(s){console.error("Socket encountered error: ",s.message,"Closing socket"),o.close(1e3)}};return(a,o)=>{const s=g("Dropzone"),e=g("LoadingIcon");return p(),x(w,null,[U,t("div",j,[t("div",E,[I(s,{"ref-key":"dropzoneFile",options:{method:"put",url:"url",uploadMultiple:!1,maxFilesize:256,paramName:a.file,addRemoveLinks:!0,autoProcessQueue:!1,acceptedFiles:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},class:"dropzone rounded-lg"},{default:B(()=>[W]),_:1},8,["options"])]),t("div",q,[l.value?(p(),D(e,{key:0,icon:"three-dots",color:"white",class:"absolute h-[30px] w-[20px] sm:w-32 mr-2 sm:mr-0 sm:h-[20px] top-3 right-1/2 translate-x-1/2"})):h("",!0),t("button",{onClick:o[0]||(o[0]=r=>F()),type:"button",class:L(["ml-auto items-center brn btn-primary rounded-lg w-full h-[35px] sm:h-[42px]",{"cursor-not-allowed":l.value}])},[l.value?h("",!0):(p(),x(w,{key:0},[N("Upload file")],64))],2)])])],64)}}};var P=z(J,[["__scopeId","data-v-3eb6c625"]]);export{P as default};
