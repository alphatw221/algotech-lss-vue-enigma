import{p as T,u as B,a as J,a0 as K,b as W,r as f,w as ne,B as X,H as oe,E as ie,x as re,o as te,a8 as ue,A as y,j as t,c as a,d as e,t as s,F as C,f as V,N as k,O as H,n as Y,h as w,e as E,S as ce,L as v,M as L,$ as Z,i as P,T as ee,k as de,l as me,y as _e,a2 as pe,a3 as ge,m as fe,g as G,a9 as he,a1 as ve,R as F}from"./lss.js";const we=(c,n,b=null)=>T(b).post(`/api/v2/campaign-quizgame/${c}/create/`,n),be=(c,n,b=null)=>T(b).put(`/api/v2/campaign-quizgame/${c}/update/`,n),xe=(c,n=null)=>T(n).delete(`/api/v2/campaign-quizgame/${c}/delete/bundle/`),ze=(c,n=null)=>T(n).delete(`/api/v2/campaign-quizgame/${c}/delete/`),$e=(c,n=null)=>T(n).get(`/api/v2/campaign-quizgame/${c}/retrieve/`),ye=(c,n=null)=>T(n).get(`/api/v2/campaign-quizgame/${c}/list/`),ke=(c,n=null)=>T(n).get(`/api/v2/campaign-quizgame/${c}/start/`),qe=(c,n=null)=>T(n).get(`/api/v2/campaign-quizgame/${c}/stop/`),Ce=(c,n=null)=>T(n).post(`/api/v2/campaign-quizgame/${c}/result/`);const Te={class:"px-5 sm:px-10"},Qe={class:"mt-5 flex justify-self-start font-medium"},De={class:"form-label mr-10"},Se={style:{display:"inline-block"}},Me={class:"flex flex-col"},Le={class:"flex justify-between col-span-12 col-start-1 mt-5"},Ve={for:"regular-form-2",class:"form-label my-auto"},Ie={class:"lg:w-[65%]"},je=["placeholder","onUpdate:modelValue"],Ae={class:"lg:w-[20%]"},Ue=["placeholder","onUpdate:modelValue"],Pe=["onClick"],Ee={class:"lg:flex"},He={class:"lg:w-full flex flex-col mt-6"},Oe={class:"form-label text-base"},Re=["placeholder"],Ne={class:"lg:flex"},Fe={class:"lg:w-[50%] flex flex-col lg:mr-5 mt-6"},Ge={class:"form-label text-base"},Be={key:0,class:"text-danger text-[14px] leading-tight"},Je={class:"lg:w-[50%] flex flex-col mt-6"},Ke={class:"form-label text-base"},We={key:0,class:"w-40 text-danger",disabled:""},Xe=["value"],Ye={key:0,class:"text-danger text-[14px] leading-tight"},Ze={class:"lg:flex"},et={class:"lg:w-[50%] flex-col mt-6 lg:mr-5"},tt={class:"flex"},at={class:"form-label text-base"},st={class:"flex sm:flex-row mt-2"},lt={class:"form-check mr-5"},nt={class:"form-check-label"},ot={class:"form-check mr-5"},it={class:"form-check-label"},rt={class:"flex justify-end my-10 text-base"},ut={__name:"QuizCreate",props:{campaignTitle:String},setup(c){const n=c,b=B();J();const g=K().appContext.config.globalProperties.eventBus,p=W();f(!0);const _=f([]),i=f({quiz_games:[{question:null,answer:null}],remark:"",num_of_winner:0,prize:"",repeatable:!1}),Q=f({question:null,answer:null}),D=f({quiz_games:[{question:null,answer:null}],remark:"",num_of_winner:0,prize:"",repeatable:!1}),x=ne(()=>({num_of_winner:{required:X,integer:oe,minValue:ie(1)},prize:{required:X}})),h=re(x,i),$=f("create"),j=f(0),M=f(!1);te(()=>{O(),g.on("editQuiz",l=>{j.value=l.quizgameBundleId,$e(j.value,p.alert).then(r=>{i.value=r.data}),$.value="edit"})});const O=()=>{ue(b.params.campaign_id,"lucky_draw",p.alert).then(l=>{_.value=l.data})},o=()=>{i.value.quiz_games.unshift(Object.assign({},Q.value))},z=(l,r)=>{[void 0,null,""].includes(r)||ze(r,p.alert).then(A=>{p.notification.showMessageToast(P.global.t("quiz_game.delete_succeed"))}),i.value.quiz_games.splice(l,1)},S=()=>{if(h.value.$touch(),h.value.$invalid){p.alert.showMessageToast(P.global.t("quiz_game.invalid_data"));return}i.value.quiz_games.forEach(l=>{if([void 0,null,""].includes(l.question)||[void 0,null,""].includes(l.answer)){M.value=!0;return}}),$.value==="create"?we(b.params.campaign_id,i.value,p.alert).then(l=>{p.notification.showMessageToast(P.global.t("quiz_game.create_succeed")),M.value=!1,g.emit("listQuiz"),i.value=D.value}):$.value==="edit"&&be(j.value,i.value,p.alert).then(l=>{p.notification.showMessageToast(P.global.t("quiz_game.update_succeed")),M.value=!1,g.emit("changePage"),g.emit("listQuiz"),$.value="create",i.value=D.value})},q=()=>{$.value==="edit"&&(p.notification.showMessageToast(P.global.t("quiz_game.not_saved")),g.emit("listQuiz"),$.value="create",i.value=D.value),g.emit("changePage")};return(l,r)=>{const A=y("HelpCircleIcon"),R=y("Tippy");return t(),a("div",Te,[e("div",Qe,[e("label",De,s(l.$t("quiz_game.quiz_create.campaign_title"))+" : ",1),e("h2",Se,s(n.campaignTitle),1)]),e("div",Me,[e("div",Le,[e("label",Ve,s(l.$t("quiz_game.quiz_create.question_title")),1),e("button",{class:"inline-block sm:rounded-lg sm:w-fit btn btn-primary ml-auto w-fit text-base h-[42px]",onClick:r[0]||(r[0]=u=>o())}," + "+s(l.$t("quiz_game.quiz_create.add_question")),1)]),(t(!0),a(C,null,V(i.value.quiz_games,(u,I)=>(t(),a("div",{class:"flex flex-col flex-wrap gap-3 mt-5 sm:flex-row sm:mt-3",key:I},[e("div",Ie,[k(e("input",{class:Y(["form-control w-full text-base",{"border-red-600":M.value}]),type:"text",placeholder:l.$t("quiz_game.quiz_create.question"),"onUpdate:modelValue":m=>u.question=m},null,10,je),[[H,u.question]])]),e("div",Ae,[k(e("input",{class:Y(["form-control w-full text-base",{"border-red-600":M.value}]),type:"text",placeholder:l.$t("quiz_game.quiz_create.answer"),"onUpdate:modelValue":m=>u.answer=m},null,10,Ue),[[H,u.answer]])]),e("button",{class:"inline-block w-full h-[42px] ml-auto text-base btn btn-danger sm:rounded-lg sm:w-24",onClick:m=>z(I,u.id)},s(l.$t("quiz_game.quiz_create.delete")),9,Pe)]))),128)),e("div",Ee,[e("div",He,[e("label",Oe,s(l.$t("quiz_game.quiz_create.remark")),1),k(e("textarea",{class:"w-full h-24 rounded-lg overflow-hidden whitespace-pre-line p-1",placeholder:l.$t("quiz_game.quiz_create.enter_remark"),"onUpdate:modelValue":r[1]||(r[1]=u=>i.value.remark=u)},null,8,Re),[[H,i.value.remark]])])]),e("div",Ne,[e("div",Fe,[e("label",Ge,s(l.$t("quiz_game.quiz_create.number_of_winner")),1),k(e("input",{class:"form-control",type:"text","onUpdate:modelValue":r[2]||(r[2]=u=>w(h).num_of_winner.$model=u)},null,512),[[H,w(h).num_of_winner.$model,void 0,{trim:!0}]]),w(h).num_of_winner.$error?(t(),a("label",Be,s(l.$t("quiz_game.quiz_create.number_winner_warning")),1)):E("",!0)]),e("div",Je,[e("label",Ke,s(l.$t("quiz_game.quiz_create.prize")),1),k(e("select",{class:"w-full form-select sm:form-select-lg rounded-lg","onUpdate:modelValue":r[3]||(r[3]=u=>w(h).prize.$model=u)},[_.value.length?(t(!0),a(C,{key:1},V(_.value,(u,I)=>(t(),a("option",{key:I,value:u,class:"w-40"},s(u.name),9,Xe))),128)):(t(),a("option",We,s(l.$t("quiz_game.quiz_create.assign_prize_err")),1))],512),[[ce,w(h).prize.$model]]),w(h).prize.$error?(t(),a("label",Ye,s(l.$t("quiz_game.quiz_create.prize_err")),1)):E("",!0)])]),e("div",Ze,[e("div",et,[e("div",tt,[e("label",at,s(l.$t("lucky_draw.draw_create.winner_repeat")),1),v(R,{class:"rounded-full w-fit whitespace-wrap ml-1","data-tippy-allowHTML":"true","data-tippy-placement":"right",content:l.$t("lucky_draw.draw_create.winner_repeat_tip"),theme:"light"},{default:L(()=>[v(A,{class:"w-5 tippy-icon"})]),_:1},8,["content"])]),e("div",st,[e("div",lt,[k(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":r[4]||(r[4]=u=>i.value.repeatable=u),value:!0},null,512),[[Z,i.value.repeatable]]),e("label",nt,s(l.$t("lucky_draw.draw_create.yes")),1)]),e("div",ot,[k(e("input",{class:"form-check-input",type:"radio","onUpdate:modelValue":r[5]||(r[5]=u=>i.value.repeatable=u),value:!1},null,512),[[Z,i.value.repeatable]]),e("label",it,s(l.$t("lucky_draw.draw_create.no")),1)])])])])]),e("div",rt,[e("button",{class:"w-32 bg-white btn dark:border-darkmode-400",onClick:r[6]||(r[6]=u=>q())},s(l.$t("lucky_draw.draw_create.cancel")),1),e("button",{class:"w-32 ml-5 shadow-md btn btn-primary",onClick:r[7]||(r[7]=u=>S())},s(l.$t("lucky_draw.draw_create.save")),1)])])}}};const ct={class:"m-3 md:m-5"},dt={class:"flex flex-col md:flex-row justify-between mb-10"},mt={class:"flex flex-wrap justify-start font-medium"},_t={class:"form-label mr-10"},pt={class:"w-42"},gt={class:"flex md:justify-end manage_btn"},ft={class:"flex flex-row flex-wrap m-[0.7rem] p-5"},ht={class:"flex-1 flex flex-col gap-4 md:w-full md:mx-2 qa_block"},vt={class:"table -mt-3 table-report responsive-table w-32"},wt={key:0,class:"whitespace-nowrap text-center text-slate-500 text-[18px]"},bt={key:1,class:"whitespace-nowrap text-center text-[16px]"},xt={key:0,class:"whitespace-norwrap text-center text-[16px]"},zt={class:"title hidden"},$t={key:1,class:"whitespace-nowrap text-center text-[16px]"},yt=["onClick"],kt=["onClick"],qt={key:2,class:"btn btn-seconday md:w-24 h-[35px] lil_btn",disabled:""},Ct=e("hr",{class:"solid"},null,-1),Tt={class:"flex-0 flex flex-row md:flex-col md:border-x-2 border-white md:ml-auto md:w-fit lil_block lil_border"},Qt={class:"flex text-slate-500 md:mx-3",style:{"font-weight":"500"}},Dt={class:"flex md:m-auto ml-auto md:text-[35px]"},St={class:"flex-0 flex flex-row flex-wrap md:w-auto md:mx-2 md:w-fit lil_block"},Mt=["onClick"],Lt={class:"flex flex-wrap mx-2 w-34"},Vt={class:"flex-0 w-9 h-9 zoom-in border-0"},It={class:"w-4 h-4 absolute right-0 bottom-0 rounded-full border-2 border-white dark:border-darkmode-600"},jt=["src"],At=["src"],Ut=["src"],Pt=["src"],Et=["src"],Ht=["src"],Ot={class:"text-base flex items-center ml-2"},Rt={key:2,class:"m-auto text-[1.5rem]"},Nt={__name:"QuizList",props:{campaignTitle:String,quizgameList:Object},setup(c){const n=c,b=f([{name:"Question",key:"question"},{name:"Answer",key:"answer"},{name:"",key:"start"}]),g=B(),p=J(),_=W(),i=K().appContext.config.globalProperties.eventBus,Q=f(["",null,void 0]),D=o=>{ke(o,_.alert).then(z=>{n.quizgameList.forEach(S=>{S.quiz_games.forEach(q=>{q.id===parseInt(o)&&(q.start_at=z.data.start_at)})})})},x=o=>{qe(o,_.alert).then(z=>{n.quizgameList.forEach(S=>{S.quiz_games.forEach(q=>{q.id===parseInt(o)&&(q.end_at=z.data.end_at)})})})},h=()=>{p.push({name:"manage-campaign-order",params:{campaign_id:g.params.campaign_id}})},$=()=>{dom(".dropdown-menu").removeClass("show")},j=o=>{i.emit("changePage"),i.emit("editQuiz",{quizgameBundleId:o}),$()},M=o=>{xe(o,_.alert).then(z=>{z.data.message==="delete success"&&_.notification.showMessageToast("Delete success"),i.emit("listQuiz")}),$()},O=o=>{Ce(o,_.alert).then(z=>{i.emit("listQuiz")})};return(o,z)=>{const S=y("Tippy"),q=y("MoreHorizontalIcon"),l=y("DropdownToggle"),r=y("SimpleIcon"),A=y("DropdownItem"),R=y("DropdownContent"),u=y("DropdownMenu"),I=y("Dropdown");return t(),a("div",ct,[e("div",dt,[e("div",mt,[e("label",_t,s(o.$t("quiz_game.quiz_list.campaign_title"))+" : ",1),e("h2",pt,s(n.campaignTitle),1)]),e("div",gt,[e("button",{class:"btn btn-primary h-[35px] md:h-[42px] my-auto lg:mr-6 w-40",onClick:z[0]||(z[0]=m=>h())},s(o.$t("campaign_live.incoming.manage_order")),1)])]),(t(!0),a(C,null,V(n.quizgameList,(m,ae)=>(t(),a("div",{class:"box bg-[#f1f1f1] text-left",key:ae},[e("div",ft,[e("div",ht,[e("table",vt,[e("thead",null,[e("tr",null,[(t(!0),a(C,null,V(b.value,(d,U)=>(t(),a(C,{key:U},[d.name?(t(),a("th",wt,s(o.$t(`quiz_game.quiz_list.${d.key}`)),1)):(t(),a("th",bt))],64))),128))])]),e("tbody",null,[(t(!0),a(C,null,V(m.quiz_games,(d,U)=>(t(),a("tr",{key:U},[(t(!0),a(C,null,V(b.value,(N,se)=>(t(),a(C,{key:se},[N.name?(t(),a("td",xt,[e("p",zt,s(o.$t(`quiz_game.quiz_list.${N.key}`)),1),e("p",null,s(d[N.key]),1)])):(t(),a("td",$t,[Q.value.includes(d.start_at)?(t(),a("button",{key:0,class:"btn btn-primary md:w-24 h-[35px] lil_btn",onClick:le=>D(d.id)},s(o.$t("quiz_game.quiz_list.start")),9,yt)):Q.value.includes(d.end_at)?(t(),a("button",{key:1,class:"btn btn-seconday md:w-24 h-[35px] lil_btn",onClick:le=>x(d.id)},s(o.$t("quiz_game.quiz_list.stop")),9,kt)):(t(),a("button",qt,s(o.$t("quiz_game.quiz_list.finish")),1))]))],64))),128))]))),128))])])]),Ct,e("div",Tt,[e("div",Qt,s(o.$t("quiz_game.quiz_list.winners")),1),e("span",Dt,s(m.num_of_winner),1)]),e("div",St,[Array.isArray(m.winner_list)&&m.winner_list.length==0?(t(),a("button",{key:0,class:"btn btn-primary md:w-32 md:h-[50px] m-auto",onClick:d=>O(m.id)},s(o.$t("quiz_game.quiz_list.result")),9,Mt)):Array.isArray(m.winner_list)&&m.winner_list.length!=0&&m.winner_list[0]!="no winners"?(t(!0),a(C,{key:1},V(m.winner_list,(d,U)=>(t(),a("div",{key:U,class:"my-2"},[e("div",Lt,[e("div",Vt,[[void 0,null,""].includes(d.customer_image)?(t(),ee(S,{key:0,tag:"img",class:"rounded-full border-0",src:`${o.storageUrl}fake_head.jpeg`},null,8,["src"])):(t(),ee(S,{key:1,tag:"img",class:"rounded-full border-0",src:d.customer_image},null,8,["src"])),e("div",It,[d.platform=="facebook"?(t(),a("img",{key:0,class:"rounded-full bg-[#3c599b]",src:w(de)},null,8,jt)):d.platform=="instagram"?(t(),a("img",{key:1,class:"rounded-full bg-[#d63376]",src:w(me)},null,8,At)):d.platform=="youtube"?(t(),a("img",{key:2,class:"rounded-full bg-[#f70000]",src:w(_e)},null,8,Ut)):d.platform=="twitch"?(t(),a("img",{key:3,class:"rounded-full bg-[#6441a5]",src:w(pe)},null,8,Pt)):d.platform=="tiktok"?(t(),a("img",{key:4,class:"rounded-full bg-[#000000]",src:w(ge)},null,8,Et)):[void 0,null,""].includes(d.platform)?(t(),a("img",{key:5,class:"rounded-full bg-[#9D9D9D]",src:w(fe)},null,8,Ht)):E("",!0)])]),e("label",Ot,s(d.customer_name),1)])]))),128)):Array.isArray(m.winner_list)&&m.winner_list.length!=0&&m.winner_list[0]=="no winners"?(t(),a("div",Rt,s(o.$t("quiz_game.quiz_list.no_winner")),1)):E("",!0)])]),v(I,{class:"absolute top-2 right-2 w-8 h-8 rounded-full whitespace-nowrap hover:bg-white p-1"},{default:L(()=>[v(l,null,{default:L(()=>[v(q,{class:"w-6 h-6"})]),_:1}),v(u,{class:"w-30"},{default:L(()=>[v(R,null,{default:L(()=>[v(A,{class:"w-20 text-center whitespace-nowrap text-[14px]",onClick:d=>j(m.id)},{default:L(()=>[v(r,{icon:"edit",color:"#2d8cf0",class:"mr-1"}),G(" "+s(o.$t("quiz_game.quiz_list.edit")),1)]),_:2},1032,["onClick"]),v(A,{class:"w-20 text-center text-danger whitespace-nowrap text-[14px]",onClick:d=>M(m.id)},{default:L(()=>[v(r,{icon:"delete",color:"#b91c1c",class:"mr-1"}),G(" "+s(o.$t("quiz_game.quiz_list.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))])}}},Ft={key:0,class:"flex flex-col h-[100%] text-lg p-3 sm:px-10 sm:m-5 gap-3 sm:gap-0"},Gt={class:"flex flex-col sm:flex-row justify-between sm:mx-5 gap-3"},Bt={class:"text-center sm:text-left text-xl sm:text-2xl font-medium my-auto"},Jt=e("span",{class:"font-bold mr-1 text-[16px]"},"+",-1),Kt={class:"box sm:mx-5 sm:mt-3"},Xt={__name:"Main",setup(c){const n=W(),b=B();J();const g=K().appContext.config.globalProperties.eventBus,p=f(!1),_=f(!1),i=f([]),Q=f("");te(()=>{he(b.params.campaign_id,n.alert).then(x=>{Q.value=x.data.title}),D(),g.on("changePage",()=>{_.value=!_.value}),g.on("listQuiz",()=>{D()})}),ve(()=>{g.off("changePage"),g.off("listQuiz")});const D=()=>{ye(b.params.campaign_id,n.alert).then(x=>{Object.entries(x.data).length>0&&(i.value=x.data,_.value=!0),p.value=!0})};return(x,h)=>p.value?(t(),a("div",Ft,[e("div",Gt,[e("h1",Bt,s(x.$t("quiz_game.title")),1),k(e("button",{class:"w-40 h-[35px] sm:h-[42px] text-white btn btn-warning btn-rounded mx-auto sm:mx-0 border-[2px] border-slate-100 shadow-lg",onClick:h[0]||(h[0]=$=>w(g).emit("changePage"))},[Jt,G(" "+s(x.$t("quiz_game.create_btn")),1)],512),[[F,_.value]])]),e("div",Kt,[k(e("div",null,[v(ut,{campaignTitle:Q.value},null,8,["campaignTitle"])],512),[[F,!_.value]]),k(e("div",null,[v(Nt,{campaignTitle:Q.value,quizgameList:i.value},null,8,["campaignTitle","quizgameList"])],512),[[F,_.value]])])])):E("",!0)}};export{Xt as default};
