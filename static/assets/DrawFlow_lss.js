import{_ as S,u as j,a as L,r as _,b as z,o as F,i as v,c as t,d as s,t as r,e as n,F as B,f as T,g as C,h as d,n as N,j as l,k as V,l as W,y as q,m as E}from"./lss.js";import{r as I,d as O}from"./campaign_lucky_draw_lss.js";var R="/assets/no winner_lss.svg",A="/assets/winner_showup_lss.svg";const G={class:"container"},M={class:"h-screen flex justify-center rounded overflow-hidden shadow-lg"},P={key:0,style:{"margin-top":"5rem"}},H=["src"],J={class:"text-center mt-7 text-2xl"},K={class:"mt-9 flex"},Q={class:"w-[50%] flex-col mr-5"},U={class:"form-label text-lg text-slate-500"},X={class:"w-[50%] flex-col"},Y={key:0,class:"form-label float-right text-lg"},Z={key:1,class:"form-label float-right text-lg"},ee={class:"mt-6 flex"},se={class:"w-[50%] flex-col mr-5"},te={class:"form-label text-lg text-slate-500"},le={class:"w-[50%] flex-col"},ae={class:"form-label float-right text-lg"},oe={class:"mt-6 flex"},re={class:"w-[50%] flex-col mr-5"},ne={class:"form-label text-lg text-slate-500"},ce={class:"w-[50%] flex-col"},ie={key:0,class:"form-label float-right text-lg"},de={key:1,class:"form-label float-right text-lg"},ue={class:"text-center mt-9 text-2xl"},_e={key:1,style:{"margin-top":"5rem"}},me={key:0,class:"text-2xl text-center"},ge=["src"],fe={class:"text-center text-2xl"},he={class:"mt-9 flex flex-wrap justify-center mx-auto xl:w-420 w-300"},pe={class:"w-full"},ve={class:"flex-0 xl:w-28 xl:h-28 w-20 h-20 zoom-in border-0"},we=["src"],ye=["src"],xe={class:"w-5 h-5 absolute right-0 bottom-0 rounded-full border-2 border-white dark:border-darkmode-600"},be=["src"],ke=["src"],De=["src"],$e=["src"],Se={key:0,class:"text-center text-[16px]"},je={key:1,class:"text-center text-[16px]"},Le={key:1,class:"text-2xl text-center"},ze=["src"],Fe={key:0,id:"cover"},Be={key:1,class:"winnerShowup"},Te=["src"],Ce=["src"],Ne=["src"],Ve={__name:"DrawFlow",props:{luckydrawList:Object},setup(We){const w="https://storage.googleapis.com/lss_bucket/static/",g=j();L();const a=_({}),f=_(!1),m=_(!1),h=_(!0),u=_([]),p=_(!1),y=z();F(()=>{I(g.params.lucky_draw_id,y.alert).then(o=>{a.value=o.data,console.log(a.value),f.value=!0}).catch(o=>{console.log(o)}),g.query.language&&(v.global.locale.value=g.query.language)});const b=o=>{m.value=!0;let i=Date.now()/1e3;console.log(i),O(o,y.alert).then(e=>{u.value=e.data,h.value=!1}).then(()=>{let e=Date.now()/1e3;console.log(e),console.log(e-i),console.log(a.value.spin_time-(e-i));let c=a.value.spin_time>e-i?(a.value.spin_time-(e-i))*1e3:0;return setTimeout(()=>{m.value=!1,console.log(u.value.length),u.value.length&&(p.value=!0,console.log("hasWinner",p.value))},c)}).catch(e=>{if(e.response.data){if(e.response.data.detail)alert(e.response.data.detail);else if(e.response.data.message){let c="";e.response.data.message.includes("helper")||e.response.data.message.includes("util")?c="error_messages."+e.response.data.message:e.response.config.url.includes("v2")?(console.log(e.response.config.url.split("/").splice(0,4).join(".")),c="error_messages"+e.response.config.url.split("/").splice(0,4).join(".")+"."+e.response.data.message):c="error_messages"+e.response.config.url.split("/").splice(0,3).join(".")+"."+e.response.data.message,console.log(c),Object.entries(e.response.data.params).forEach(([x,k])=>{if(x.split("_")[0]==="datetime"){let D=vueLangToBrowserLang.value[v.global.locale.value],$=new Intl.DateTimeFormat(D,{dateStyle:"short",timeStyle:"medium"}).format(new Date(k));e.response.data.params[x]=$}}),alert(v.global.t(c,e.response.data.params))}}else alert("error ! please refresh the page.")})};return(o,i)=>(l(),t("div",null,[s("div",G,[s("div",M,[f.value===!0&&h.value===!0?(l(),t("div",P,[s("img",{class:"m-3 self-center",src:a.value.prize.image,style:{width:"300px",height:"300px"}},null,8,H),s("div",J,r(a.value.prize.name),1),s("div",K,[s("div",Q,[s("label",U,r(o.$t(`lucky_draw.draw_list.${a.value.type}`)),1)]),s("div",X,[a.value.type=="keyword"?(l(),t("label",Y,r(a.value.comment),1)):a.value.type=="product"?(l(),t("label",Z,r(a.value.campaign_product.name),1)):n("",!0)])]),s("div",ee,[s("div",se,[s("label",te,r(o.$t("lucky_draw.draw_flow.winner")),1)]),s("div",le,[s("label",ae,r(a.value.num_of_winner),1)])]),s("div",oe,[s("div",re,[s("label",ne,r(o.$t("lucky_draw.draw_flow.repeatable")),1)]),s("div",ce,[a.value.repeatable==!0?(l(),t("label",ie,r(o.$t("lucky_draw.draw_flow.yes")),1)):(l(),t("label",de,r(o.$t("lucky_draw.draw_flow.no")),1))])]),s("div",ue,[s("button",{class:"btn btn-primary w-48 h-16 mt-auto",onClick:i[0]||(i[0]=e=>b(a.value.id))},r(o.$t("lucky_draw.draw_flow.draw_now")),1)])])):f.value===!0&&h.value===!1?(l(),t("div",_e,[u.value.length!=0?(l(),t("div",me,r(o.$t("lucky_draw.draw_flow.congrates"))+" !",1)):n("",!0),s("img",{class:"mx-auto my-8 self-center",src:a.value.prize.image,style:{width:"300px",height:"300px"}},null,8,ge),s("div",fe,r(a.value.prize.name),1),s("div",he,[(l(!0),t(B,null,T(u.value,(e,c)=>(l(),t("div",{key:c,class:"mb-3 mx-3"},[s("div",pe,[s("div",ve,[e.customer_image==""||e.customer_image==null?(l(),t("img",{key:0,class:"rounded-full border-0 w-full",src:`${d(w)}fake_head.jpeg`},null,8,we)):(l(),t("img",{key:1,class:"rounded-full border-0 w-full",src:e.customer_image},null,8,ye)),s("div",xe,[e.platform=="facebook"?(l(),t("img",{key:0,class:"rounded-full bg-[#3c599b]",src:d(V)},null,8,be)):n("",!0),e.platform=="instagram"?(l(),t("img",{key:1,class:"rounded-full bg-[#d63376]",src:d(W)},null,8,ke)):n("",!0),e.platform=="youtube"?(l(),t("img",{key:2,class:"rounded-full bg-[#f70000]",src:d(q)},null,8,De)):n("",!0),e.platform==null?(l(),t("img",{key:3,class:"rounded-full bg-[#9D9D9D]",src:d(E)},null,8,$e)):n("",!0)])])]),e.customer_name?(l(),t("p",Se,r(e.customer_name),1)):(l(),t("p",je," Guest "))]))),128))]),u.value.length==0?(l(),t("div",Le,[C(r(o.$t("lucky_draw.draw_flow.no_winner"))+" ",1),s("img",{src:d(R)},null,8,ze)])):n("",!0)])):n("",!0)])]),m.value?(l(),t("div",Fe)):n("",!0),p.value?(l(),t("div",Be,[s("img",{class:"mx-auto",src:d(A)},null,8,Te)])):n("",!0),s("div",{id:"draw_animation",class:N({show:m.value,hide:!m.value})},[a.value.animation==""?(l(),t("img",{key:0,class:"mx-auto",src:`${d(w)}lucky_draw1.svg`},null,8,Ce)):(l(),t("img",{key:1,class:"mx-auto",src:a.value.animation},null,8,Ne))],2)]))}};var Ie=S(Ve,[["__scopeId","data-v-eba04f5e"]]);export{Ie as default};
