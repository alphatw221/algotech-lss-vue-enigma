import{X as Te,r as _,u as Z,a as ee,a0 as ae,b as A,w as le,A as h,j as e,c as t,d as l,t as i,N as ne,S as Le,F as b,f as O,h as T,e as I,O as Ee,ad as ze,ae as je,L as c,T as H,R as Ne,_ as be,o as oe,a1 as he,ap as Oe,z as We,g as R,n as _e,W as Fe,M as E,aq as Ve,i as pe,ar as Ue,as as Re,U as He,V as Xe,$ as Ae,at as qe,a4 as ke,au as Ge,av as Je,aw as Ke}from"./lss.js";const me=Te("sellerStock",{state:()=>({showBulkEditModal:_(!1),productCategoryDict:_({}),selectedProductIDList:_([])})}),Ye={class:"flex flex-wrap justify-start w-full gap-2 sm:flex-row"},Qe={key:0,class:"flex w-full sm:w-fit justify-between sm:justify-start"},Ze={class:"flex"},et={class:"mr-2 my-auto whitespace-nowrap"},tt={value:""},ot=["value"],st={class:"flex"},lt={class:"relative"},nt=["placeholder","onKeydown"],ve={__name:"SearchBar",props:{showCategoryFilter:Boolean,searchEventBusName:String},setup(M){const g=M;Z();const f=ee(),w=me(),p=ae().appContext.config.globalProperties.eventBus,r=_(""),$=_("name"),v=_(""),k=A(),s=le(()=>w.selectedProductIDList.length>0),o=le(()=>((w==null?void 0:w.selectedProductIDList)||[]).length),a=()=>{p.emit(g.searchEventBusName,{searchColumn:$.value,keyword:r.value,categoryID:v.value})},C=()=>{$.value="name",r.value="",v.value="",a()},D=()=>{w.showBulkEditModal=!0};return(y,u)=>{var j,z,q,G,J,K;const x=h("SearchIcon"),P=h("XIcon");return e(),t("form",null,[l("div",Ye,[M.showCategoryFilter?(e(),t("div",Qe,[l("div",Ze,[l("label",et,i(y.$t("stock.search_bar.category")),1),ne(l("select",{class:"w-auto h-[35px] sm:h-[42px] rounded-lg form-select-sm sm:form-select","onUpdate:modelValue":u[0]||(u[0]=B=>v.value=B),onChange:a},[l("option",tt,i(y.$t("product_category.all")),1),(e(!0),t(b,null,O((j=T(k).userInfo.user_subscription)==null?void 0:j.product_categories,(B,te)=>(e(),t("option",{key:te,value:B.id},i(B.name),9,ot))),128))],544),[[Le,v.value]])]),(K=(J=(G=(q=(z=T(k))==null?void 0:z.userInfo)==null?void 0:q.user_subscription)==null?void 0:G.user_plan)==null?void 0:J.hide)!=null&&K.edit_category_button?I("",!0):(e(),t("button",{key:0,type:"button",class:"btn btn-primary shadow-md w-32 h-[35px] sm:h-[42px] ml-3",onClick:u[1]||(u[1]=B=>T(f).push({name:"category-management"}))},i(y.$t("stock.search_bar.category_manage")),1))])):I("",!0),l("div",st,[l("div",lt,[ne(l("input",{type:"text",class:"mr-2 form-control w-40 lg:w-60 rounded-lg",placeholder:y.$t("stock.search_bar.search_holder"),"onUpdate:modelValue":u[2]||(u[2]=B=>r.value=B),onKeydown:ze(je(a,["prevent"]),["enter"])},null,40,nt),[[Ee,r.value]]),c(x,{class:"absolute w-7 h-7 top-1 sm:top-2 right-4 z-10 text-slate-600",onClick:u[3]||(u[3]=B=>a())})]),r.value?(e(),H(P,{key:0,class:"flex-none w-7 h-7 mt-2 text-slate-600",onClick:u[4]||(u[4]=B=>C())})):I("",!0),ne(l("button",{type:"button",class:"btn btn-primary shadow-md w-32 h-[35px] lg:h-[42px] ml-4",onClick:u[5]||(u[5]=B=>D())},i(y.$t("stock.search_bar.bulk_edit"))+"("+i(o.value)+") ",513),[[Ne,s.value]])])])])}}};const xe=M=>(He("data-v-9578a772"),M=M(),Xe(),M),at={class:"overflow-x-hidden sm:overflow-auto h-fit sm:h-[56vh]"},ct={class:"table -mt-3 table-report min-h-[300px]"},rt={key:1,class:"text-center"},it={key:2,class:"row flex justify-end"},dt={class:"text-right"},ut={key:4,class:"flex justify-start"},pt={key:0,class:"h-[300px]"},_t=["colspan"],mt=["colspan"],ht={class:"mt-40 text-center md:mt-10"},kt={class:"text-slate-500 text-sm md:text-lg font-bold"},ft=["colspan"],vt={class:"mt-40 text-center md:mt-10"},wt={class:"text-slate-500 text-sm md:text-lg font-bold"},yt={key:0,class:"w-10"},gt=["onUpdate:modelValue","onClick"],bt=["data-content"],xt={class:"flex justify-center"},$t={key:0,class:"w-20 h-20 image-fit zoom-in lg:w-12 lg:h-12"},Ct=["src"],It={key:1,class:"w-20 h-20 image-fit zoom-in lg:w-12 lg:h-12"},St=["src"],Dt=["data-content"],Pt=["data-content"],Bt=["data-content"],Mt={class:"text-right"},Tt={class:"text-[12px]"},Lt=["data-content"],Et=["onClick"],zt={class:"font-bold"},jt={key:1,class:"flex gap-2 cursor-not-allowed justify-center"},Nt=xe(()=>l("span",{class:"font-bold"}," (0) ",-1)),Ot={key:1,class:"flex gap-2 cursor-not-allowed justify-center"},Wt=xe(()=>l("span",{class:"font-bold"}," (0) ",-1)),Ft=["data-content"],Vt={class:"place-content-center flex"},Ut=["data-content"],Rt={__name:"DataTable",props:{product_status:String,searchEventBusName:String},setup(M){const g=M,f=me();Z();const w=ee();_([{text:"for_sale",id:"enabled"},{text:"delisted",id:"disabled"}]);const p=le(()=>{var m,N,X,Q,se,ie,F,de,ue;var n=[{name:"check",key:"check"},{name:"image",key:"image"},{name:"name",key:"name",sortable:!0},{name:"order_code",key:"order_code",sortable:!0},{name:"category",key:"categories"},{name:"remark",key:"remark"},{name:"qty",key:"qty",sortable:!0},{name:"price_ori",key:"price_ori",sortable:!0},{name:"price",key:"price",sortable:!0},{name:"wishlist",key:"wishlist"},{name:"",key:"edit"}];return(X=(N=(m=u.userInfo)==null?void 0:m.user_subscription.user_plan)==null?void 0:N.hide)!=null&&X.stock_table_check&&(n=n.filter(V=>V.key!="check")),(ie=(se=(Q=u.userInfo)==null?void 0:Q.user_subscription)==null?void 0:se.user_plan.hide)!=null&&ie.stock_table_wishlist&&(n=n.filter(V=>V.key!="wishlist")),(ue=(de=(F=u.userInfo)==null?void 0:F.user_subscription)==null?void 0:de.user_plan.hide)!=null&&ue.stock_table_edit&&(n=n.filter(V=>V.key!="edit")),n}),r=_(1),$=_(1),v=_(50),k=_(0),s=_(""),o=_(""),a=_([]),C=_(""),D=_("");_([]);const y="https://storage.googleapis.com/lss_public_bucket/static/",u=A(),x=_(!0),P=ae().appContext.config.globalProperties.eventBus,j=le(()=>a.value.length);oe(()=>{z(),P.on(g.searchEventBusName,n=>{r.value=1,s.value=n.searchColumn,o.value=n.keyword,C.value=n.categoryID,z()}),P.on("refreshStockTable",()=>{r.value=1,z()})}),he(()=>{P.off(g.searchEventBusName)});const z=()=>{x.value=!0,a.value=[],Oe("",v.value,r.value,s.value,o.value,g.product_status,"",C.value,"",D.value,u.alert).then(n=>{if(n.data.count!=null){k.value=n.data.count;const m=parseInt(n.data.count/v.value);$.value=m==0?1:m}a.value=n.data.results,x.value=!1,console.log(a.value)})},q=()=>{a.value.forEach((n,m)=>{f.selectedProductIDList.includes(n.id)?(console.log("in"),n.check=!0):n.check=!1})};We(le(()=>a.value),q);const G=n=>{r.value=n,z()},J=n=>{v.value=n,z()},K=n=>{w.push({name:"edit-product",params:{product_id:n.id}}),B()},B=()=>{Ve(".dropdown-menu").removeClass("show")},te=(n,m)=>{confirm(`${pe.global.t("stock.table_column.confirm_delete")}`)&&Ue(n.id,u.alert).then(X=>{a.value.splice(m,1),f.selectedProductIDList=f.selectedProductIDList.filter(Q=>Q!=n.id)}),B()},ce=(n,m)=>{Re(n.id,u.alert).then(N=>{a.value.splice(m,0,N.data)}),B()},W=(n,m)=>{D.value=m+n,z()},Y=()=>{D.value="",z()},re=n=>{n.target.checked?a.value.forEach(m=>{m.check=!0,f.selectedProductIDList.includes(m.id)||f.selectedProductIDList.push(m.id)}):a.value.forEach(m=>{m.check=!1,f.selectedProductIDList=[]})},$e=(n,m)=>{m.target.checked?n.id in f.selectedProductIDList||f.selectedProductIDList.push(n.id):f.selectedProductIDList=f.selectedProductIDList.filter(N=>N!=n.id),console.log(f.selectedProductIDList)},Ce=n=>{console.log("xxx",n),P.emit("showWishlistModal",{wishlist:n.meta.wish_list,id:n.id})};return(n,m)=>{const N=h("ChevronsUpIcon"),X=h("XIcon"),Q=h("ChevronsDownIcon"),se=h("ChevronDownIcon"),ie=h("LoadingIcon"),F=h("SimpleIcon"),de=h("MoreHorizontalIcon"),ue=h("DropdownToggle"),V=h("DropdownItem"),Ie=h("DropdownContent"),Se=h("DropdownMenu"),De=h("Dropdown"),Pe=h("Page");return e(),t(b,null,[l("div",at,[l("table",ct,[l("thead",null,[l("tr",null,[(e(!0),t(b,null,O(p.value,d=>(e(),t("th",{class:"whitespace-normal text-left lg:whitespace-nowrap text-[16px]",key:d.key},[d.key==="check"?(e(),t("input",{key:0,class:"form-control form-check-input w-[1.2rem] h-[1.2rem] sm:mr-1 my-auto",type:"checkbox",onChange:m[0]||(m[0]=L=>re(L))},null,32)):d.key==="image"?(e(),t("div",rt,i(n.$t("stock.table_column."+d.name)),1)):d.key==="price"?(e(),t("div",it,[l("div",dt,i(n.$t("stock.table_column."+d.name)),1),d.sortable===!0?(e(),t(b,{key:0},[D.value[0]==="-"&&D.value.substr(1,d.key.length)===d.key?(e(),t(b,{key:0},[c(N,{class:"ml-3 h-5 w-5 text-white bg-[#131c34] opacity-[.85] rounded-full right-[5%] z-50",onClick:L=>W(d.key,"")},null,8,["onClick"]),c(X,{class:"w-5 h-5 text-slate-400 cursor-pointer",onClick:m[1]||(m[1]=L=>Y())})],64)):D.value===d.key?(e(),t(b,{key:1},[c(Q,{class:"ml-3 h-5 w-5 text-white bg-[#131c34] opacity-[.85] rounded-full right-[5%] z-50",onClick:L=>W(d.key,"-")},null,8,["onClick"]),c(X,{class:"w-5 h-5 text-slate-400 cursor-pointer",onClick:m[2]||(m[2]=L=>Y())})],64)):(e(),H(se,{key:2,class:"ml-3 h-5 w-5 text-black bg-null opacity-[.85] rounded-full right-[5%] z-50",onClick:L=>W(d.key,"-")},null,8,["onClick"]))],64)):I("",!0)])):d.key==="edit"?(e(),t(b,{key:3},[R(i(""))],64)):(e(),t("div",ut,[R(i(n.$t("stock.table_column."+d.name))+" ",1),d.sortable===!0?(e(),t(b,{key:0},[D.value[0]==="-"&&D.value.substr(1,d.key.length)===d.key?(e(),t(b,{key:0},[c(N,{class:"ml-3 h-5 w-5 text-white bg-[#131c34] opacity-[.85] rounded-full right-[5%] z-50",onClick:L=>W(d.key,"")},null,8,["onClick"]),c(X,{class:"w-5 h-5 text-slate-400 cursor-pointer",onClick:m[3]||(m[3]=L=>Y())})],64)):D.value===d.key?(e(),t(b,{key:1},[c(Q,{class:"ml-3 h-5 w-5 text-white bg-[#131c34] opacity-[.85] rounded-full right-[5%] z-50",onClick:L=>W(d.key,"-")},null,8,["onClick"]),c(X,{class:"w-5 h-5 text-slate-400 cursor-pointer",onClick:m[4]||(m[4]=L=>Y())})],64)):(e(),H(se,{key:2,class:"ml-3 h-5 w-5 text-black bg-null opacity-[.85] rounded-full right-[5%] z-50",onClick:L=>W(d.key,"-")},null,8,["onClick"]))],64)):I("",!0)]))]))),128))])]),l("tbody",null,[x.value||j.value==0?(e(),t("tr",pt,[x.value?(e(),t("td",{key:0,class:"items-center relative tdDot",colspan:p.value.length+2},[c(ie,{icon:"three-dots",color:"1a202c",class:"absolute w-[60px] h-[60px] right-[50%] top-[50%] translate-x-1/2"})],8,_t)):j.value==0&&o.value==""?(e(),t("td",{key:1,colspan:p.value.length+2,class:"TDshadow"},[l("div",ht,[l("h1",kt,i(n.$t("stock.no_result."+M.product_status)),1)])],8,mt)):j.value==0?(e(),t("td",{key:2,colspan:p.value.length+2,class:"TDshadow"},[l("div",vt,[l("h1",wt,i(n.$t("stock.no_result."+M.product_status)),1)])],8,ft)):I("",!0)])):I("",!0),(e(!0),t(b,null,O(a.value,(d,L)=>(e(),t("tr",{key:L,class:_e(["intro-x",{trBorder:j.value!=0}])},[(e(!0),t(b,null,O(p.value,(S,Be)=>(e(),t(b,{key:Be},[S.key=="check"?(e(),t("td",yt,[ne(l("input",{class:"form-control form-check-input w-[1.2rem] h-[1.2rem] sm:mr-1 my-auto selectCheck",type:"checkbox","onUpdate:modelValue":U=>d.check=U,onClick:U=>$e(d,U)},null,8,gt),[[Fe,d.check]])])):S.key==="image"?(e(),t("td",{key:1,class:"w-fit text-[12px] lg:w-18 lg:text-sm 2xl:w-32 imgtd","data-content":n.$t(`stock.table_column.${S.key}`)},[l("div",xt,[d.image?(e(),t("div",$t,[l("img",{class:"w-full rounded-lg",src:d.image,"data-action":"zoom"},null,8,Ct)])):(e(),t("div",It,[l("img",{class:"w-full rounded-lg",src:`${T(y)}no_image.jpeg`,"data-action":"zoom"},null,8,St)]))])],8,bt)):S.key==="categories"?(e(),t("td",{key:2,class:"w-full sm:w-32 category","data-content":n.$t(`stock.table_column.${S.key}`)},[(e(!0),t(b,null,O(d[S.key],(U,Me)=>{var fe;return e(),t("div",{key:Me},[l("div",null,i((fe=T(f).productCategoryDict[U])==null?void 0:fe.name),1)])}),128))],8,Dt)):S.key==="qty"?(e(),t("td",{key:3,class:"w-full sm:w-32 text-left","data-content":n.$t(`stock.table_column.${S.key}`)},i(d[S.key]),9,Pt)):S.key==="price"?(e(),t("td",{key:4,class:"w-full sm:w-32","data-content":n.$t(`stock.table_column.${S.key}`)},[l("div",Mt,[l("span",Tt,i(T(u).userInfo.user_subscription.currency),1),R(" "+i((Math.floor(parseFloat(d[S.key])*10**T(u).userInfo.user_subscription.decimal_places)/10**T(u).userInfo.user_subscription.decimal_places).toLocaleString("en-GB"))+" "+i(T(u).userInfo.user_subscription.price_unit?n.$t(`global.price_unit.${T(u).userInfo.user_subscription.price_unit}`):""),1)])],8,Bt)):S.key==="wishlist"?(e(),t("td",{key:5,class:"w-full sm:w-fit wishlist","data-content":n.$t(`stock.table_column.${S.key}`)},[d.meta.wish_list?(e(),t(b,{key:0},[Object.keys(d.meta.wish_list).length>0?(e(),t("div",{key:0,class:"flex gap-2 cursor-pointer justify-center",onClick:U=>Ce(d)},[c(F,{icon:"wishlist",width:"24",height:"24"}),l("span",zt," ("+i(Object.keys(d.meta.wish_list).length)+")",1)],8,Et)):(e(),t("div",jt,[c(F,{icon:"wishlist",width:"24",height:"24"}),Nt]))],64)):(e(),t("div",Ot,[c(F,{icon:"wishlist",width:"24",height:"24"}),Wt]))],8,Lt)):S.key==="edit"?(e(),t("td",{key:6,class:"w-24 table-report__action edit","data-content":n.$t(`stock.table_column.${S.key}`)},[l("div",Vt,[c(De,{placement:"bottom-start"},{default:E(()=>[c(ue,{role:"button",class:"block w-5 h-5",href:"javascript:;"},{default:E(()=>[c(de,{class:"w-5 h-5 text-slate-700"})]),_:1}),c(Se,{class:"w-28 pt-2"},{default:E(()=>[c(Ie,{class:"w-28 text-center"},{default:E(()=>[c(V,{class:"w-28 text-center whitespace-nowrap text-[14px]",onClick:U=>K(d)},{default:E(()=>[c(F,{icon:"edit",color:"#2d8cf0",class:"mr-1"}),R(" "+i(n.$t("stock.category_manage.edit")),1)]),_:2},1032,["onClick"]),c(V,{class:"w-28 text-center whitespace-nowrap text-[14px]",onClick:U=>ce(d,L)},{default:E(()=>[c(F,{icon:"copy",color:"#2d8cf0",class:"mr-1"}),R(" "+i(n.$t("stock.category_manage.duplicate")),1)]),_:2},1032,["onClick"]),c(V,{class:"w-28 text-center text-danger whitespace-nowrap text-[14px]",onClick:U=>te(d,L)},{default:E(()=>[c(F,{icon:"delete",color:"#b91c1c",class:"mr-1"}),R(" "+i(n.$t("stock.category_manage.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])],8,Ft)):(e(),t("td",{key:7,class:"text-left","data-content":n.$t(`stock.table_column.${S.key}`)},i(d[S.key]),9,Ut))],64))),128))],2))),128))])])]),c(Pe,{class:"mx-auto my-3 flex flex-row flex-wrap justify-center gap-1 mb-10",total:k.value,"show-sizer":"","page-size-opts":[20,50,100,500,1e3],"page-size":v.value,onOnChange:G,onOnPageSizeChange:J},null,8,["total","page-size"])],64)}}};var we=be(Rt,[["__scopeId","data-v-9578a772"]]);const Ht={class:"mt-1"},Xt={for:"regular-form-2",class:"form-label w-full text-center font-medium",style:{"font-size":"1.2rem"}},At={for:"crud-form-2",class:"form-label text-base mt-2 font-medium"},qt=["value"],Gt={class:"form-label text-base mt-5 font-medium"},Jt={class:"flex"},Kt=["value","checked"],Yt={class:"form-check-label text-base"},Qt={class:"flex justify-between"},Zt={__name:"BulkEditModal",setup(M){const g=me();Z(),ee();const f=_([{text:"for_sale",key:"enabled"},{text:"delisted",key:"disabled"}]),w=_([]),p=_("enabled"),r=A(),$=ae().appContext.config.globalProperties.eventBus,v=()=>{g.showBulkEditModal=!1,w.value=[],p.value="enabled"},k=()=>{qe({categories:w.value,status:p.value,stock_id_list:g.selectedProductIDList},r.alert).then(s=>{g.selectedProductIDList=[],$.emit("refreshStockTable"),v()})};return(s,o)=>{const a=h("TomSelect"),C=h("ModalBody"),D=h("Modal");return e(),H(D,{show:T(g).showBulkEditModal,onHidden:o[4]||(o[4]=y=>v()),backdrop:"static"},{default:E(()=>[c(C,{class:"p-10"},{default:E(()=>[l("div",Ht,[l("label",Xt,i(s.$t("stock.bulk_edit_modal.bulk_edit")),1),l("label",At,i(s.$t("product_category.product_category")),1),c(a,{id:"crud-form-2",multiple:"",placeholder:s.$t("stock.bulk_edit_modal.select_a_category"),modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=y=>w.value=y)},{default:E(()=>{var y;return[(e(!0),t(b,null,O((y=T(r).userInfo.user_subscription)==null?void 0:y.product_categories,(u,x)=>(e(),t("option",{key:x,value:u.id},i(u.name),9,qt))),128))]}),_:1},8,["placeholder","modelValue"]),l("label",Gt,i(s.$t("product.status")),1),l("div",Jt,[(e(!0),t(b,null,O(f.value,y=>(e(),t("div",{class:"ml-3",key:y.key},[ne(l("input",{type:"radio","onUpdate:modelValue":o[1]||(o[1]=u=>p.value=u),value:y.key,checked:p.value==y.key,style:{color:"black"}},null,8,Kt),[[Ae,p.value]]),l("label",Yt,i(s.$t(`product.status_options.${y.key}`)),1)]))),128))])]),l("div",Qt,[l("button",{class:"w-32 shadow-md btn btn-secondary mt-7",onClick:o[2]||(o[2]=y=>v())},i(s.$t("stock.bulk_edit_modal.cancel")),1),l("button",{class:"w-32 shadow-md btn btn-primary mt-7",onClick:o[3]||(o[3]=y=>k())},i(s.$t("stock.bulk_edit_modal.save")),1)])]),_:1})]),_:1},8,["show"])}}},eo={class:"relative"},to=l("div",{class:"ml-2"},"Sync EasyStore Product ",-1),ye="easy_store",oo={__name:"ExportProductButton",setup(M){const{cookies:g}=ke(),f=g.get("access_token");Z(),ee();const w=A(),p=_(!1),r=_(!1);oe(()=>{var k,s;(s=(k=w.userInfo.user_subscription.user_plan)==null?void 0:k.plugins)!=null&&s[ye]&&(p.value=!0)});const $=()=>{r.value=!0,v(!0)},v=k=>{const s=new WebSocket(`wss://v2login.liveshowseller.com/ws/plugin/${ye}/product/export/?token=${f}`);s.onmessage=o=>{const a=JSON.parse(o.data);console.log(a),a.type==="response_data"&&(r.value=!0),a.type==="result_data"&&(a.data.result=="complete"?location.reload():w.alert.showMessageToast("export_fail, please try again or contect support team."),r.value=!1,s.close(1e3))},s.onopen=o=>{k?(s.send("export"),console.log("export")):console.log("reconnect")},s.onclose=o=>{o.code!=1e3&&v(!1),console.error("socket closed"),r.value=!1},s.onerror=function(o){console.error("Socket encountered error: ",o.message,"Closing socket"),s.close(1e3)}};return(k,s)=>{const o=h("LoadingIcon"),a=h("font-awesome-icon");return e(),t("div",eo,[p.value?(e(),t("button",{key:0,onClick:s[0]||(s[0]=C=>$()),type:"button",class:_e(["h-[35px] w-56 mr-2 sm:mr-0 sm:h-[50px] text-white font-medium shadow-lg btn btn-warning rounded-full mb-5 sm:mb-0 border-[2px] border-slate-100",{"cursor-not-allowed":r.value}])},[r.value?(e(),H(o,{key:0,icon:"three-dots",color:"white",class:"absolute h-[30px] w-[30px] sm:w-40 mr-2 sm:mr-0 sm:h-[20px] top-4"})):r.value?I("",!0):(e(),t(b,{key:1},[c(a,{icon:"fa-solid fa-arrows-rotate",class:"relative h-5 mb-0.5 mr-2",width:"19",color:"white"}),to],64))],2)):I("",!0)])}}},so={class:"relative"},lo=l("div",null,"Sync OrdrStartr Product",-1),ge="ordr_startr",no={__name:"ExportProductButton",setup(M){const{cookies:g}=ke(),f=g.get("access_token");Z(),ee();const w=A(),p=_(!1),r=_(!1);oe(()=>{var k,s;(s=(k=w.userInfo.user_subscription.user_plan)==null?void 0:k.plugins)!=null&&s[ge]&&(p.value=!0)});const $=()=>{r.value=!0,v(!0)},v=k=>{const s=new WebSocket(`wss://v2login.liveshowseller.com/ws/plugin/${ge}/product/export/?token=${f}`);s.onmessage=o=>{const a=JSON.parse(o.data);console.log(a),a.type==="response_data"&&(r.value=!0),a.type==="result_data"&&(a.data.result=="complete"?location.reload():w.alert.showMessageToast("export_fail, please try again or contect support team."),r.value=!1,s.close(1e3))},s.onopen=o=>{k?(s.send("export"),console.log("export")):console.log("reconnect")},s.onclose=o=>{o.code!=1e3&&v(!1),console.error("socket closed"),r.value=!1},s.onerror=function(o){console.error("Socket encountered error: ",o.message,"Closing socket"),s.close(1e3)}};return(k,s)=>{const o=h("LoadingIcon"),a=h("font-awesome-icon");return e(),t("div",so,[r.value?(e(),H(o,{key:0,icon:"three-dots",color:"1a202c",class:"absolute h-[30px] w-[30px] sm:w-40 mr-2 sm:mr-0 sm:h-[20px] top-3"})):I("",!0),p.value?(e(),t("button",{key:1,onClick:s[0]||(s[0]=C=>$()),type:"button",class:_e(["h-[35px] w-fit mr-2 sm:mr-0 sm:h-[50px] text-white font-medium shadow-lg btn btn-warning rounded-full mb-5 border-[2px] border-slate-100",{"cursor-not-allowed":r.value}])},[c(a,{icon:"fa-solid fa-arrows-rotate",class:"relative h-5 mb-0.5 mr-2",width:"19",color:"white"}),lo],2)):I("",!0)])}}},ao={class:"relative"},co=l("div",null,"Sync Shopify Product ",-1),ro="shopify",io={__name:"ExportProductButton",setup(M){const{cookies:g}=ke(),f=g.get("access_token");Z(),ee();const w=A(),p=_(!1),r=_(!1);oe(()=>{var k,s;(s=(k=w.userInfo.user_subscription.user_plan)==null?void 0:k.plugins)!=null&&s[ro]&&(p.value=!0)});const $=()=>{r.value=!0,v(!0)},v=k=>{const s=new WebSocket(`wss://v2login.liveshowseller.com/ws/plugin/shopify/product/export/?token=${f}`);s.onmessage=o=>{const a=JSON.parse(o.data);console.log(a),a.type==="response_data"&&(r.value=!0),a.type==="result_data"&&(a.data.result=="complete"?location.reload():w.alert.showMessageToast("export_fail, please try again or contect support team."),r.value=!1,s.close(1e3))},s.onopen=o=>{k?(s.send("export"),console.log("export")):console.log("reconnect")},s.onclose=o=>{o.code!=1e3&&v(!1),console.error("socket closed"),r.value=!1},s.onerror=function(o){console.error("Socket encountered error: ",o.message,"Closing socket"),s.close(1e3)}};return(k,s)=>{const o=h("LoadingIcon"),a=h("font-awesome-icon");return e(),t("div",ao,[p.value?(e(),t("button",{key:0,onClick:s[0]||(s[0]=C=>$()),type:"button",class:_e(["h-[35px] w-48 mr-2 sm:mr-0 sm:h-[42px] text-white font-medium shadow-lg btn btn-warning rounded-full mb-auto sm:mb-0 border-[2px] border-slate-100",{"cursor-not-allowed":r.value}])},[r.value?(e(),H(o,{key:0,icon:"three-dots",color:"white",class:"absolute h-[30px] w-[30px] sm:w-40 mr-2 sm:mr-0 sm:h-[20px] top-4"})):r.value?I("",!0):(e(),t(b,{key:1},[c(a,{icon:"fa-solid fa-arrows-rotate",class:"relative h-5 mb-0.5 mr-2",width:"19",color:"white"}),co],64))],2)):I("",!0)])}}};const uo={class:"flex flex-row justify-center gap-2 font-medium text-center text-xl w-full"},po={class:"flex flex-col gap-3"},_o={class:"table table-report table-auto -mt-3",style:{"text-align":"inherit"}},mo={key:0,class:"break-all w-fit"},ho={key:1,class:"break-all w-fit"},ko={__name:"WishlistModal",setup(M){const g=A(),f=ae().appContext.config.globalProperties.eventBus,w=_(!1),p=_(""),r=_([{key:"name",name:"name"},{key:"email",name:"email"}]),$=_([]);oe(()=>{f.on("showWishlistModal",s=>{w.value=!0,p.value=s.id,Object.entries(s.wishlist).forEach(([o,a])=>{$.value.push({email:o,name:a}),console.log(r.value)})})}),he(()=>{f.off("showWishlistModal")});const v=()=>{w.value=!1,$.value=[]},k=()=>{confirm(`${pe.global.t("stock.wishlist.confirm_send")}`)?Ge(p.value,g.alert).then(o=>{g.notification.showMessageToast(`${pe.global.t("stock.wishlist.success_send")}`),f.emit("refreshStockTable"),v()}):g.alert.showMessageToast(`${pe.global.t("stock.wishlist.cancel_send")}`)};return(s,o)=>{const a=h("XIcon"),C=h("ModalHeader"),D=h("MailIcon"),y=h("ModalBody"),u=h("Modal");return e(),H(u,{backdrop:"static",size:"modal-lg",slideOver:!0,show:w.value,onHidden:o[2]||(o[2]=x=>v())},{default:E(()=>[c(C,{class:"p-5"},{default:E(()=>[l("h2",uo,i(s.$t("stock.wishlist.title"))+" ("+i($.value.length)+")",1),c(a,{class:"absolute right-0 top-0 mt-3 mr-3 w-8 h-8 text-slate-400",onClick:o[0]||(o[0]=x=>v())})]),_:1}),c(y,null,{default:E(()=>[l("div",po,[l("button",{class:"btn btn-primary ml-auto",onClick:o[1]||(o[1]=x=>k())},[c(D,{class:"mr-2 w-5"}),R(" "+i(s.$t("stock.wishlist.mail_to")),1)]),l("table",_o,[l("thead",null,[l("tr",null,[(e(!0),t(b,null,O(r.value,x=>(e(),t("th",{class:"whitespace-nowrap text-left",key:x.key},i(s.$t(`stock.wishlist.${x.key}`)),1))),128))])]),l("tbody",null,[(e(!0),t(b,null,O($.value,x=>(e(),t("tr",{key:x},[(e(!0),t(b,null,O(r.value,P=>(e(),t(b,{key:P.key},[P.key=="email"?(e(),t("td",mo,i(x[P.key]?x[P.key]:"None"),1)):P.key=="name"?(e(),t("td",ho,i(x[P.key].name?x[P.key].name:"None"),1)):I("",!0)],64))),128))]))),128))])])])]),_:1})]),_:1},8,["show"])}}};var fo=be(ko,[["__scopeId","data-v-28316c19"]]);const vo={class:"flex items-center sm:px-20 lg:pt-5 mt-3 pb-4 intro-y"},wo={class:"text-xl sm:text-2xl mx-auto sm:mx-0 font-medium"},yo={class:"flex flex-col p-2 sm:gap-5 box sm:px-8 h-fit lg:mx-20"},go={class:"flex flex-wrap justify-between gap-3 mx-0 mt-5"},bo={key:0,class:"switch-toggle"},xo={for:"on"},$o={for:"off"},Co={class:"flex ml-auto"},Io={class:"hidden sm:block"},So={class:"mr-1 text-lg font-bold text-[#ff9505] inline-block align-middle"},Do={class:"block sm:hidden"},Po={class:"hidden sm:block"},Bo=l("span",{class:"mr-1 text-lg font-bold"},"+",-1),Mo={class:"block sm:hidden"},To={key:0,class:"flex flex-col gap-3 leading-relaxed"},Lo={key:1,class:"flex flex-col gap-3 leading-relaxed sm:gap-5"},zo={__name:"Main",setup(M){const g=_(1),f=ae().appContext.config.globalProperties.eventBus;Z();const w=ee(),p=A(),r=me();oe(()=>{$(),v()}),he(()=>{f.off("refreshStockTable")});const $=()=>{r.productCategoryDict={},r.selectedProductIDList=[]},v=()=>{var o,a;(a=(o=p.userInfo.user_subscription)==null?void 0:o.product_categories)==null||a.forEach(C=>{r.productCategoryDict[C.id.toString()]=C})},k=o=>{g.value=o},s=o=>{let a=new FormData;a.append("file",o),Ke(a,p.alert).then(C=>{p.userInfo=C.data,$(),v(),f.emit("refreshStockTable")})};return(o,a)=>{var y,u,x,P,j,z,q,G,J,K,B,te,ce,W,Y;const C=h("ArrowDownIcon"),D=h("PlusIcon");return e(),t(b,null,[l("div",vo,[l("h2",wo,i(o.$t("stock.stock")),1)]),l("div",yo,[l("div",go,[(j=(P=(x=(u=(y=T(p))==null?void 0:y.userInfo)==null?void 0:u.user_subscription)==null?void 0:x.user_plan)==null?void 0:P.hide)!=null&&j.stock_table_tabs?I("",!0):(e(),t("div",bo,[l("input",{id:"on",name:"state-d",type:"radio",checked:"checked",onClick:a[0]||(a[0]=re=>k(1))}),l("label",xo,i(o.$t("stock.for_sale")),1),l("input",{id:"off",name:"state-d",type:"radio",onClick:a[1]||(a[1]=re=>k(2))}),l("label",$o,i(o.$t("stock.delisted")),1)])),l("div",Co,[c(oo),c(no),c(io),(K=(J=(G=(q=(z=T(p))==null?void 0:z.userInfo)==null?void 0:q.user_subscription)==null?void 0:G.user_plan)==null?void 0:J.display)!=null&&K.import_product_button?(e(),H(Je,{key:0,class:"text-sm h-[35px] w-[40px] sm:w-40 mr-2 sm:mr-2 sm:h-[42px] text-[#ff9505] bg-[#fefce8] font-medium shadow-lg btn color-[#f59e0b] border-[#fcd34d] hover:bg-[#fef6e8] rounded-full mb-5 border-[2px] border-slate-100",button_id:"import_product",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",multiple:!1,uploadFunction:s},{default:E(()=>[l("template",Io,[l("span",So,[c(C,{class:""})]),R(" "+i(o.$t("stock.import_product")),1)]),l("template",Do,[c(C,{class:"w-8 h-8"})])]),_:1})):I("",!0),(Y=(W=(ce=(te=(B=T(p))==null?void 0:B.userInfo)==null?void 0:te.user_subscription)==null?void 0:ce.user_plan)==null?void 0:W.hide)!=null&&Y.add_product_button?I("",!0):(e(),t("button",{key:1,type:"button",class:"h-[35px] w-[35px] sm:w-40 mr-2 sm:mr-0 sm:h-[42px] text-white font-medium shadow-lg btn btn-warning rounded-full mb-5 border-[2px] border-slate-100",onClick:a[2]||(a[2]=re=>T(w).push({name:"add-product"}))},[l("template",Po,[Bo,R(" "+i(o.$t("stock.add_product")),1)]),l("template",Mo,[c(D,{class:"w-8 h-8"})])]))])]),g.value==1?(e(),t("div",To,[c(ve,{searchEventBusName:"searchForSaleTable",showCategoryFilter:!0}),c(we,{class:"overflow-x-auto",product_status:"enabled",searchEventBusName:"searchForSaleTable"})])):I("",!0),g.value==2?(e(),t("div",Lo,[c(ve,{searchEventBusName:"searchDelistedTable",showCategoryFilter:!0}),c(we,{product_status:"disabled",searchEventBusName:"searchDelistedTable"})])):I("",!0)]),c(Zt),c(fo)],64)}}};export{zo as default};
