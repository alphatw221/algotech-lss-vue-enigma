import{_ as Q,ax as ee,r as y,a0 as X,o as O,a1 as te,A as k,j as n,T as N,M as S,L as w,d as e,t as s,c as i,h as l,U as W,V as J,b as oe,u as ae,a as se,w as le,x as de,ay as re,ah as ne,N as m,O as $,n as M,e as I,R as ie,F as A,f as E,W as ce,B as D,C as j,H as pe,E as H,D as ue,i as T,az as me,aA as _e,g as ge,$ as fe}from"./lss.js";const ve=u=>(W("data-v-512720b8"),u=u(),J(),u),be={class:"flex flex-col gap-2 px-2 justify-start"},he={class:"text-xl"},ke=["src"],xe=["src"],$e={key:2,class:"text-lg"},ye={key:3,class:"text-lg"},we={class:"text-xl text-left font-medium"},Ve=ve(()=>e("div",{id:"description",class:"text-left description"},null,-1)),ze={__name:"ItemDescriptionModal",props:{status:String},setup(u){const c=u,v="https://storage.googleapis.com/lss_public_bucket/static/",_=ee(),V=y(!1),r=X().appContext.config.globalProperties.eventBus,g=y([]);return O(()=>{r.on("showDescriptionModal",z=>{V.value=!0,g.value=z;var b=document.getElementById("description");b.innerHTML=g.value.description})}),te(()=>{r.off("showDescriptionModal")}),(z,b)=>{const R=k("XIcon"),h=k("ModalBody"),f=k("Modal");return n(),N(f,{show:V.value,onHidden:b[1]||(b[1]=d=>!V.value),backdrop:"static"},{default:S(()=>[w(h,{class:"text-center"},{default:S(()=>{var d,p,B,F,L;return[w(R,{class:"w-7 h-7 absolute top-1 right-2",onClick:b[0]||(b[0]=P=>V.value=!1)}),e("div",be,[e("div",he,s(g.value.name),1),g.value.image?(n(),i("img",{key:0,src:g.value.image,class:"w-[300px] h-[300px] mx-auto object-cover rounded-lg"},null,8,ke)):(n(),i("img",{key:1,src:l(v)+"no_image.jpeg",class:"w-[300px] h-[300px] mx-auto object-cover rounded-lg"},null,8,xe)),(c.status="PREVIEW")?(n(),i("div",$e," $"+s(g.value.price),1)):(n(),i("div",ye,s((d=l(_).order.campaign)==null?void 0:d.currency)+" "+s((Math.floor(parseFloat(g.value.price)*10**((p=l(_).order.campaign)==null?void 0:p.decimal_places))/10**((B=l(_).order.campaign)==null?void 0:B.decimal_places)).toLocaleString("en-GB"))+" "+s((F=l(_).order.campaign)!=null&&F.price_unit?z.$t(`global.price_unit.${(L=l(_).order.campaign)==null?void 0:L.price_unit}`):""),1)),e("div",we,s(z.$t("shopping_cart.add_item.description")),1),Ve])]}),_:1})]),_:1},8,["show"])}}};var Me=Q(ze,[["__scopeId","data-v-512720b8"]]);const Ie=u=>(W("data-v-5b9cfb9c"),u=u(),J(),u),Se={class:"h-fit"},Ce={key:0,class:"flex items-center sm:px-20 lg:pt-5 mt-3 pb-4 intro-y"},Ue={class:"text-xl sm:text-2xl mx-auto sm:mx-0 font-medium"},Be={key:1,class:"flex items-center sm:px-20 lg:pt-5 mt-3 pb-4 intro-y"},Fe={class:"text-xl sm:text-2xl mx-auto sm:mx-0 font-medium"},Le={class:"box grid grid-cols-12 gap-4 p-5 intro-y lg:mx-20 lg:px-40 px-10 py-10"},De={class:"col-span-12 lg:col-span-6 col-start-1 mt-2"},Te={for:"crud-form-1",class:"form-label text-base font-medium"},Re={key:0,class:"text-danger ml-2 text-[13px]"},qe={class:"col-span-12 lg:col-span-6 tom"},Ae={for:"crud-form-2",class:"form-label text-base mt-2 font-medium"},Ee=["value"],je=["value"],Ne={class:"col-span-12 col-start-1 drop"},Pe={class:"form-label text-base mt-2 font-medium"},He={class:"relative"},Qe={key:0},Xe={class:"text-lg font-medium"},Oe={class:"text-gray-600"},We=Ie(()=>e("br",null,null,-1)),Je={class:"text-gray-600"},Ge=["src"],Ke={class:"col-span-12 lg:col-span-12 col-start-1 mt-2"},Ye={for:"crud-form-1",class:"form-label text-base font-medium"},Ze={key:0,class:"text-danger ml-2 text-[13px]"},et={class:"col-start-1 col-span-12 lg:col-span-6 mt-2"},tt={for:"crud-form-1",class:"form-label text-base font-medium"},ot=["placeholder"],at={class:"col-span-12 lg:col-span-6 mt-2"},st={for:"crud-form-1",class:"form-label text-base font-medium"},lt=["placeholder"],dt={key:0,class:"text-danger ml-2 text-[13px]"},rt={class:"col-span-12 lg:col-span-6 col-start-1 mt-2"},nt={for:"crud-form-1",class:"form-label text-base font-medium"},it=["placeholder"],ct={class:"col-span-12 lg:col-span-6 col-start-1 mt-2"},pt={for:"crud-form-1",class:"form-label text-base font-medium"},ut=["placeholder","disabled"],mt={key:0,class:"text-danger ml-2 text-[13px]"},_t={class:"col-span-6 col-start-1 mt-2"},gt={class:"text-base font-medium"},ft={class:"mt-2 ml-2 mr-2 form-check sm:mt-0"},vt=["value","onUpdate:modelValue"],bt=["for"],ht={class:"col-span-6 mt-2"},kt={class:"flex flex-row gap-3"},xt={class:"text-base font-medium"},$t={class:"col-span-12 mt-2"},yt={class:"flex justify-between"},wt={for:"crud-form-1",class:"form-label text-base font-medium"},Vt={key:0,class:"text-danger ml-2 text-[13px]"},zt={class:"col-span-12 mt-2"},Mt={for:"crud-form-1",class:"form-label text-base font-medium"},It=["placeholder"],St={key:0,class:"text-danger ml-2 text-[13px]"},Ct={class:"z-50 col-span-12 flex justify-end sm:mt-3"},Ut={__name:"Main",setup(u){const c=oe(),v=ae(),_=se(),V=X().appContext.config.globalProperties.eventBus,r=y({id:0,name:"",image:"",type:null,order_code:null,description:"",qty:0,price:0,price_ori:0,status:"enabled",remark:"",categories:[],sku:"",pinned:!1}),g=t=>o=>!o.includes(t),z=le(()=>({name:{required:D,maxLength:j(255)},order_code:{required:D,maxLength:j(10)},description:{notContains:g("<head>")},qty:{required:D,integer:pe,minValue:H(1)},price:{required:D,decimal:ue,minValue:H(0)},remark:{maxLength:j(100)}})),b={toolbar:{items:["heading","|","bold","italic","strikethrough","underline","link","|","blockQuote","insertTable","|","specialCharacters","horizontalLine","pageBreak","|","-","undo","redo"]}},R=y([{text:"for_sale",id:"enabled"},{text:"delisted",id:"disabled"}]),h=y("");y([]);const f=new FormData,d=de(z,r);O(()=>{v.params.product_id&&re(v.params.product_id,c.alert).then(t=>{var o;r.value=t.data,console.log(r.value),r.value.description=((o=r.value)==null?void 0:o.description)||"",h.value=t.data.image?t.data.image:null})});const p=y(null);ne("bind[dropzoneSingleRef]",t=>{p.value=t,t.dropzone.on("addedfile",o=>{const C=t.dropzone.getAcceptedFiles();C.length>0&&t.dropzone.removeFile(C[0])})});const B=()=>{const t=p.value.dropzone.getAcceptedFiles();t.length>0&&p.value.dropzone.removeFile(t[0]),h.value=""},F=()=>{if(typeof r.value.price_ori!="number"&&r.value.price_ori==null,d.value.$touch(),d.value.$invalid){c.alert.showMessageToast(T.global.t("stock.add_product_page.invalid_data"));return}v.params.product_id?(h.value===""&&(r.value.image===""||p.value.dropzone.getAcceptedFiles()[0]===void 0)?f.append("image","._no_image"):f.append("image",p.value.dropzone.getAcceptedFiles()[0]),f.append("data",JSON.stringify(r.value)),me(v.params.product_id,f,c.alert).then(t=>{_.push({name:"stock"}),c.notification.showMessageToast(T.global.t("stock.add_product_page.update_message"))})):(f.append("image",p.value.dropzone.getAcceptedFiles()[0]||"._no_image"),f.append("data",JSON.stringify(r.value)),_e(f,c.alert).then(t=>{c.notification.showMessageToast(T.global.t("stock.add_product_page.create_message")),_.push({name:"stock"})}))},L=()=>{_.push({name:"stock"}),c.alert.showMessageToast(T.global.t("stock.add_product_page.not_save_message"))},P=()=>{var t;(t=p.value.dropzone.getAcceptedFiles()[0])!=null&&t.dataURL&&(r.value.image=p.value.dropzone.getAcceptedFiles()[0].dataURL),V.emit("showDescriptionModal",r.value)};return(t,o)=>{const C=k("TomSelect"),G=k("Dropzone"),K=k("XCircleIcon"),Y=k("Tippy"),Z=k("ClassicEditor");return n(),i("div",Se,[l(v).params.product_id?(n(),i("div",Ce,[e("h2",Ue,s(t.$t("stock.add_product_page.edit_title")),1)])):(n(),i("div",Be,[e("h2",Fe,s(t.$t("stock.add_product_page.add_title")),1)])),e("div",Le,[e("div",De,[e("label",Te,s(t.$t("stock.add_product_page.product_name")),1),m(e("input",{id:"crud-form-1",type:"text",class:M(["w-full form-control h-[40px]",{"border-danger text-danger border-2":l(d).name.$error}]),placeholder:"","onUpdate:modelValue":o[0]||(o[0]=a=>l(d).name.$model=a)},null,2),[[$,l(d).name.$model]]),l(d).name.$error?(n(),i("label",Re,s(t.$t("stock.add_product_page.name_warning")),1)):I("",!0)]),e("div",qe,[e("label",Ae,s(t.$t("stock.add_product_page.category")),1),l(v).params.product_id?(n(),N(C,{key:0,id:"crud-form-2",modelValue:r.value.categories,"onUpdate:modelValue":o[1]||(o[1]=a=>r.value.categories=a),class:"w-full",options:{create:!1},multiple:""},{default:S(()=>{var a,x;return[(n(!0),i(A,null,E((x=(a=l(c).userInfo)==null?void 0:a.user_subscription)==null?void 0:x.product_categories,(U,q)=>(n(),i("option",{key:q,value:U.id},s(U.name),9,Ee))),128))]}),_:1},8,["modelValue"])):(n(),N(C,{key:1,id:"crud-form-2",modelValue:r.value.categories,"onUpdate:modelValue":o[2]||(o[2]=a=>r.value.categories=a),options:{create:!1},class:"w-full",multiple:""},{default:S(()=>{var a,x;return[(n(!0),i(A,null,E((x=(a=l(c).userInfo)==null?void 0:a.user_subscription)==null?void 0:x.product_categories,(U,q)=>(n(),i("option",{key:q,value:U.id},s(U.name),9,je))),128))]}),_:1},8,["modelValue"]))]),e("div",Ne,[e("label",Pe,s(t.$t("stock.add_product_page.upload_image")),1),e("div",He,[w(G,{"ref-key":"dropzoneSingleRef",options:{method:"put",url:"url",uploadMultiple:!1,maxFilesize:10,addRemoveLinks:!0,autoProcessQueue:!1,resizeQuality:.5,acceptedFiles:"image/*"},class:"dropzone"},{default:S(()=>[h.value?(n(),i("img",{key:1,class:"w-40 h-40 rounded-lg","data-dz-thumbnail":"",src:h.value},null,8,Ge)):(n(),i("div",Qe,[e("div",Xe,s(t.$t("stock.add_product_page.drop_file_text")),1),e("div",Oe,[We,ge(s(t.$t("stock.add_product_page.accept_file_text")),1)]),e("div",Je,s(t.$t("stock.add_product_page.max_size_text")),1)]))]),_:1}),m(w(Y,{tag:"a",href:"javascript:;",class:"absolute right-0 top-0 tooltip",content:t.$t("create_campaign.payment_form.remove_image"),options:{theme:"light"}},{default:S(()=>[w(K,{class:"absolute right-0 top-0 z-10 click-icon text-danger",onClick:o[3]||(o[3]=a=>B())})]),_:1},8,["content"]),[[ie,h.value]])])]),e("div",Ke,[e("label",Ye,s(t.$t("stock.add_product_page.quantity")),1),m(e("input",{id:"crud-form-1",type:"number",class:M(["w-full form-control",{"border-danger text-danger border-2":l(d).qty.$error}]),placeholder:"Input Qty","onUpdate:modelValue":o[4]||(o[4]=a=>l(d).qty.$model=a)},null,2),[[$,l(d).qty.$model,void 0,{number:!0}]]),l(d).qty.$error?(n(),i("label",Ze,s(t.$t("stock.add_product_page.qty_warning")),1)):I("",!0)]),e("div",et,[e("label",tt,s(t.$t("stock.add_product_page.price_ori")),1),m(e("input",{id:"crud-form-1",type:"number",class:"w-full form-control",placeholder:t.$t("stock.add_product_page.price_ori_input"),"onUpdate:modelValue":o[5]||(o[5]=a=>r.value.price_ori=a)},null,8,ot),[[$,r.value.price_ori,void 0,{number:!0}]])]),e("div",at,[e("label",st,s(t.$t("stock.add_product_page.price")),1),m(e("input",{id:"crud-form-1",type:"number",class:M(["w-full form-control",{"border-danger text-danger border-2":l(d).price.$error}]),placeholder:t.$t("stock.add_product_page.price_input"),"onUpdate:modelValue":o[6]||(o[6]=a=>l(d).price.$model=a)},null,10,lt),[[$,l(d).price.$model,void 0,{number:!0}]]),l(d).price.$error?(n(),i("label",dt,s(t.$t("stock.add_product_page.price_warning")),1)):I("",!0)]),e("div",rt,[e("label",nt,s(t.$t("stock.add_product_page.sku")),1),m(e("input",{id:"crud-form-1",type:"text",class:"w-full form-control",placeholder:t.$t("stock.add_product_page.sku_input"),"onUpdate:modelValue":o[7]||(o[7]=a=>r.value.sku=a)},null,8,it),[[$,r.value.sku]])]),e("div",ct,[e("label",pt,s(t.$t("stock.add_product_page.order_code")),1),m(e("input",{id:"crud-form-1",type:"text",class:M(["w-full form-control",{"border-danger text-danger border-2":l(d).order_code.$error}]),placeholder:t.$t("stock.add_product_page.order_code_input"),"onUpdate:modelValue":o[8]||(o[8]=a=>l(d).order_code.$model=a),disabled:r.value.type==="lucky_draw"},null,10,ut),[[$,l(d).order_code.$model]]),l(d).order_code.$error?(n(),i("label",mt,s(t.$t("stock.add_product_page.order_code_warning")),1)):I("",!0)]),e("div",_t,[e("label",gt,s(t.$t("stock.add_product_page.status")),1),(n(!0),i(A,null,E(R.value,a=>(n(),i("div",{class:"flex flex-col mt-2 sm:flex-row",key:a.id},[e("div",ft,[m(e("input",{class:"form-check-input",type:"radio",name:"horizontal_radio_button1",value:a.id,"onUpdate:modelValue":x=>r.value.status=x},null,8,vt),[[fe,r.value.status]]),e("label",{class:"form-check-label",for:a.id},s(t.$t(`stock.${a.text}`)),9,bt)])]))),128))]),e("div",ht,[e("div",kt,[m(e("input",{class:"form-control form-check-input w-[1.2rem] h-[1.2rem] my-auto",type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=a=>r.value.pinned=a)},null,512),[[ce,r.value.pinned]]),e("label",xt,s(t.$t("stock.add_product_page.pinned")),1)])]),e("div",$t,[e("div",yt,[e("label",wt,s(t.$t("stock.add_product_page.description")),1),e("button",{class:"btn btn-secondary mb-2 h-[35px]",onClick:o[10]||(o[10]=a=>P())},s(t.$t("stock.add_product_page.preview")),1)]),w(Z,{class:M({"border-danger text-danger border-2":l(d).description.$error}),modelValue:l(d).description.$model,"onUpdate:modelValue":o[11]||(o[11]=a=>l(d).description.$model=a),config:b},null,8,["class","modelValue"]),l(d).description.$error?(n(),i("label",Vt,s(t.$t("stock.add_product_page.description_warning")),1)):I("",!0)]),e("div",zt,[e("label",Mt,s(t.$t("stock.add_product_page.remark")),1),m(e("textarea",{class:M([{"border-danger text-danger border-2":l(d).remark.$error},"h-36 p-2 mr-5 form-control indent-4"]),placeholder:t.$t("stock.add_product_page.placeholder_remark"),"onUpdate:modelValue":o[12]||(o[12]=a=>l(d).remark.$model=a)},`
				`,10,It),[[$,l(d).remark.$model]]),l(d).remark.$error?(n(),i("label",St,s(t.$t("stock.add_product_page.remark_warning")),1)):I("",!0)]),e("div",Ct,[e("button",{class:"w-32 bg-white btn dark:border-darkmode-400",onClick:o[13]||(o[13]=a=>L())},s(t.$t("stock.add_product_page.cancel")),1),e("button",{class:"w-32 ml-5 shadow-md btn btn-primary",onClick:o[14]||(o[14]=a=>F())},s(t.$t("stock.add_product_page.save")),1)])]),w(Me,{status:"PREVIEW"})])}}};var Ft=Q(Ut,[["__scopeId","data-v-5b9cfb9c"]]);export{Ft as default};
