import{_ as te,b as ae,s as se,v as le,u as oe,a as ne,r as g,w as V,x as ie,z as re,o as ue,A as S,c as i,d as o,t as r,F as x,f as w,B as f,C as ce,D as U,E as N,G as P,H as pe,I as O,J as _e,i as me,K as de,j as n,n as h,L as p,M as y,N as z,O as ve,h as m,e as E,P as L,Q as B,R as fe,S as ge,T as M,U as ye,V as he}from"./lss.js";import{_ as be,P as xe,a as we}from"./NotesForm_lss.js";import{_ as Ie,a as $e}from"./MessageSettings_lss.js";const Se=k=>(ye("data-v-20abf92e"),k=k(),he(),k),ke={class:"flex flex-col h-[100%] text-[16px]"},De={class:"flex items-center sm:px-20 lg:pt-5 mt-3 pb-4 intro-y"},Ve={class:"text-xl sm:text-2xl font-medium mx-auto sm:mx-0"},Ne={class:"col-span-12 col-start-1 sm:col-span-6"},Oe={class:"flex flex-col"},ze={class:"flex"},Me={id:"title",class:"w-fit my-auto text-base form-label font-medium"},Te={key:0,class:"text-danger text-[14px] ml-2"},Ce={class:"col-span-12 sm:col-span-6"},Je={class:"flex flex-col"},He={class:"flex whitespace-nowrap align-middle"},Re={for:"regular-form-2",class:"w-fit my-auto text-base form-label font-medium"},Ue={class:"flex items-center justify-center"},Pe=["value"],Ee=["value"],Le={class:"text-xl font-medium leading-none lg:-mx-6"},Be=Se(()=>o("hr",{class:"-mx-6 my-4"},null,-1)),qe={class:"flex flex-col"},Ke={value:null},je=["value"],Fe={class:"flex flex-col w-full"},Ge=["value"],Ae={class:"flex flex-col"},Ye={class:"flex flex-row gap-3"},Qe={class:""},Ze=["value"],We={class:"flex flex-col"},Xe={class:"flex flex-row gap-3"},et=["value"],tt={class:"flex flex-col"},at={class:"mr-5"},st=["value"],lt={class:"box shadow-none col-span-12 flex justify-end lg:mx-20 lg:px-40 py-10 mt-3"},ot={__name:"Main",setup(k){const s=ae(),q=se(),T=le();oe();const K=ne(),I=g(""),C=g([]),$=g({start:new Date,end:new Date}),j=Intl.DateTimeFormat().resolvedOptions().timeZone,F=g([{value:"USD",text:"USD"},{value:"NTD",text:"NTD"},{value:"SGD",text:"SGD"},{value:"IDR",text:"IDR"},{value:"PHP",text:"PHP"},{value:"MYR",text:"MYR"},{value:"VND",text:"VND"},{value:"RMB",text:"RMB"},{value:"KHR",text:"KHR"},{value:"AUD",text:"AUD"},{value:"HKD",text:"HKD"}]),G=g([{key:"1",value:"1"},{key:"1000",value:"1000"},{key:"1000000",value:"1000000"}]),A=g([{value:"en",text:"English"},{value:"zh_hans",text:"Chinese-simplify"},{value:"zh_hant",text:"Chinese-tranditional"},{value:"vi",text:"Vietnamese"}]),Y=g([{value:"2",text:"0.01"},{value:"0",text:"1"}]),a=g({title:"",start_at:new Date,end_at:new Date,supplier:null,meta_logistic:{delivery_charge:0,is_free_delivery_for_order_above_price:!1,free_delivery_for_order_above_price:1,is_free_delivery_for_how_many_order_minimum:!1,free_delivery_for_how_many_order_minimum:1,is_additional_delivery_charge:!0,additional_delivery_options:[],pickup_options:[],delivery_note:"",delivery_date:{daterange:[],start_at:null,end_at:null,options:[]}},country:"SG",currency:"USD",lang:"en",lang:"en",decimal_places:2,price_unit:"1",meta_payment:{special_note:"",confirmation_note:""},meta_reply:{},meta_point:{},meta:{}}),b=g({meta_logistic:{delivery_note:""},meta_payment:{special_note:"",confirmation_note:""}}),J=V(()=>{var e=["date","general","logistics","payments","points","messages","notes"];return s.userInfo.user_subscription.type=="kol"&&(e=e.filter(t=>t!="points"),e=e.filter(t=>t!="payments")),a.value.supplier&&(e=e.filter(t=>t!="logistics"),e=e.filter(t=>t!="messages"),e=e.filter(t=>t!="notes")),e}),Q=V(()=>{let e={title:{required:f,maxLength:ce(50)},meta_logistic:{delivery_charge:{required:f,decimal:U,minValue:N(0)},free_delivery_for_order_above_price:{required:P(()=>a.value.meta_logistic.is_free_delivery_for_order_above_price==!0),decimal:U,minValue:N(.01)},free_delivery_for_how_many_order_minimum:{required:P(()=>a.value.meta_logistic.is_free_delivery_for_how_many_order_minimum==!0),integer:pe,minValue:N(1)},additional_delivery_options:{$each:O.forEach({region:{required:f},title:{required:f},type:{required:f},price:{required:f,numeric:_e}})},pickup_options:{$each:O.forEach({name:{required:f},address:{required:f}})}},supplier:{}};return J.value.includes("payments")&&(e.meta_payment={direct_payment:{v2_accounts:{$each:O.forEach({mode:{required:f},name:{required:f},number:{required:f}})}}}),e}),_=ie(Q,a);re(V(()=>$.value),()=>{a.value.start_at=$.value.start,a.value.end_at=$.value.end},{deep:!0}),ue(()=>{var t;if(!s.userInfo.user_subscription)return;s.userInfo.user_subscription.currency&&(a.value.currency=s.userInfo.user_subscription.currency),s.userInfo.user_subscription.buyer_lang&&(a.value.lang=s.userInfo.user_subscription.buyer_lang),s.userInfo.user_subscription.country&&(a.value.country=s.userInfo.user_subscription.country),[void 0,null,""].includes(s.userInfo.user_subscription.decimal_places)||(a.value.decimal_places=s.userInfo.user_subscription.decimal_places.toString()),s.userInfo.user_subscription.price_unit&&(a.value.price_unit=s.userInfo.user_subscription.price_unit),s.userInfo.user_subscription.meta_point&&(a.value.meta_point=JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_point)));const e=new Set;s.userInfo.user_subscription.meta_country.activated_country.forEach(u=>{T[u].forEach(v=>e.add(v))}),e.forEach(u=>{u in s.userInfo.user_subscription.meta_payment?a.value.meta_payment[u]=JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_payment[u])):(a.value.meta_payment[u]={},T[u].fields.forEach(v=>{a.value.meta_payment[u][v.key]=v.default}),a.value.meta_payment[u].enabled=!1)}),Object.entries(s.userInfo.user_subscription.meta_logistic).length&&(Object.assign(a.value.meta_logistic,JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_logistic))),a.value.meta_logistic.delivery_date=(t=s.userInfo.user_subscription.meta_logistic)!=null&&t.delivery_date?s.userInfo.user_subscription.meta_logistic.delivery_date:{start_at:null,end_at:null,options:[]}),b.value.meta_logistic.delivery_note=s.userInfo.user_subscription.meta_logistic.delivery_note?JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_logistic.delivery_note)):"",b.value.meta_payment.special_note=s.userInfo.user_subscription.meta_payment.special_note?JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_payment.special_note)):"",b.value.meta_payment.confirmation_note=s.userInfo.user_subscription.meta_payment.confirmation_note?JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_payment.confirmation_note)):"",s.userInfo.user_subscription.meta_reply&&(a.value.meta_reply=JSON.parse(JSON.stringify(s.userInfo.user_subscription.meta_reply)))});const Z=()=>{if(_.value.$touch(),_.value.$invalid){_.value.$errors.forEach(t=>{console.log(t),s.alert.showMessageToast(t.$property+" is "+me.global.t("vulidate."+t.$validator)),document.querySelector("#lss-content").scrollTo(0,0)});return}if(a.value.meta_logistic.delivery_note=b.value.meta_logistic.delivery_note,a.value.meta_payment.special_note=b.value.meta_payment.special_note,a.value.meta_payment.confirmation_note=b.value.meta_payment.confirmation_note,I.value)a.value.meta={stock_subscription_id:I.value};else if(!I.value&&["stock_subscription_id"].includes(a.value.meta)){const t=a.value.meta.indexOf("stock_subscription_id");a.value.meta.splice(t,-1)}a.value.meta=I.value?{stock_subscription_id:I.value}:{};let e=new FormData;e.append("data",JSON.stringify(a.value)),C.value.forEach((t,u)=>{const v=a.value.meta_payment.direct_payment.v2_accounts[u].name+"_"+u;e.append(v,t)}),de(e,s.alert).then(t=>{console.log("create campaign",t.data),q.campaign=t.data,K.push({name:"assign-product",params:{campaign_id:t.data.id}})})};return(e,t)=>{const u=S("HelpCircleIcon"),v=S("Tippy"),W=S("ChevronsRightIcon"),X=S("v-date-picker"),D=S("TomSelect");return n(),i("div",ke,[o("div",De,[o("h2",Ve,r(e.$t("create_campaign.create_campaign")),1)]),(n(!0),i(x,null,w(J.value,(c,ee)=>{var H,R;return n(),i(x,{key:ee},[c=="date"?(n(),i("div",{key:0,class:h([c,"box grid grid-cols-12 gap-4 p-5 intro-y lg:mx-20 lg:px-40"])},[o("div",Ne,[o("div",Oe,[o("div",ze,[o("label",Me,r(e.$t("create_campaign.title")),1),p(v,{class:"rounded-full w-fit whitespace-wrap ml-1 my-auto","data-tippy-allowHTML":"true","data-tippy-placement":"right",content:e.$t("tooltips.create_campaign.title")},{default:y(()=>[p(u,{class:"w-5 tippy-icon"})]),_:1},8,["content"])]),z(o("input",{class:h(["w-full form-control",{"border-danger":m(_).title.$error}]),type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>m(_).title.$model=l),onBlur:t[1]||(t[1]=(...l)=>m(_).title.$touch&&m(_).title.$touch(...l))},null,34),[[ve,m(_).title.$model,void 0,{trim:!0}]])]),m(_).title.$error?(n(),i("label",Te,r(e.$t("create_campaign.title_required")),1)):E("",!0)]),o("div",Ce,[o("div",Je,[o("div",He,[o("label",Re,r(e.$t("create_campaign.period")),1),p(v,{class:"rounded-full w-fit whitespace-wrap ml-1 my-auto","data-tippy-allowHTML":"true","data-tippy-placement":"right",content:e.$t("tooltips.create_campaign.campaign_period")},{default:y(()=>[p(u,{class:"w-5 tippy-icon"})]),_:1},8,["content"])]),p(X,{class:"z-49",modelValue:$.value,"onUpdate:modelValue":t[2]||(t[2]=l=>$.value=l),timezone:m(j),columns:1,mode:"dateTime","is-range":"","is-required":"",is24hr:"","min-date":new Date},{default:y(({inputValue:l,inputEvents:d})=>[o("div",Ue,[o("input",L({value:l.start},B(d.start,!0),{class:"form-control border h-[42px] px-2 py-1 w-42 rounded focus:outline-none focus:border-indigo-300"}),null,16,Pe),p(W,{class:"w-8 h-8 m-1"}),o("input",L({value:l.end},B(d.end,!0),{disabled:"",class:"form-control border h-[42px] px-2 py-1 w-42 rounded focus:outline-none focus:border-indigo-300"}),null,16,Ee)])]),_:1},8,["modelValue","timezone","min-date"])])])],2)):c=="general"?(n(),i("div",{key:1,class:h([c,"box p-5 lg:mx-20 lg:px-40 mt-3 sm:p-8 text-sm sm:text-lg flex flex-col gap-3"])},[o("span",Le,r(e.$t("create_campaign.general_settings")),1),Be,z(o("div",qe,[o("span",null,r(e.$t("create_campaign.selling_type")),1),z(o("select",{class:"form-select h-[35px] sm:h-[42px] w-full","onUpdate:modelValue":t[3]||(t[3]=l=>m(_).supplier.$model=l)},[o("option",Ke,r(e.$t("create_campaign.my_stock")),1),(n(!0),i(x,null,w((H=m(s).userInfo.user_subscription.meta_store)==null?void 0:H.support_stock_user_subscriptions,(l,d)=>(n(),i("option",{key:d,value:l.user_subscription_id},r(l.name),9,je))),128))],512),[[ge,m(_).supplier.$model]])],512),[[fe,(R=m(s).userInfo.user_subscription.meta_store)==null?void 0:R.support_stock_user_subscriptions]]),o("div",Fe,[o("span",null,r(e.$t("settings.localization.currency_symbol")),1),p(D,{modelValue:a.value.currency,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.currency=l),options:{placeholder:e.$t("settings.localization.choose_currency_symbol")},class:"w-full"},{default:y(()=>[(n(!0),i(x,null,w(F.value,(l,d)=>(n(),i("option",{value:l.value,key:d},r(l.text),9,Ge))),128))]),_:2},1032,["modelValue","options"])]),o("div",Ae,[o("div",Ye,[o("span",Qe,r(e.$t("settings.localization.buyer_language")),1),p(v,{class:"rounded-full whitespace-wrap","data-tippy-allowHTML":"true","data-tippy-placement":"right",content:e.$t("tooltips.settings.local.buyer_lang")},{default:y(()=>[p(u,{class:"h-5 ml-1 mt-0.5 tippy-icon"})]),_:1},8,["content"])]),p(D,{modelValue:a.value.lang,"onUpdate:modelValue":t[5]||(t[5]=l=>a.value.lang=l),options:{placeholder:e.$t("settings.localization.choose_language")},class:"w-full"},{default:y(()=>[(n(!0),i(x,null,w(A.value,(l,d)=>(n(),i("option",{value:l.value,key:d},r(e.$t(`settings.localization.languages.${l.value}`)),9,Ze))),128))]),_:2},1032,["modelValue","options"])]),o("div",We,[o("div",Xe,[o("span",null,r(e.$t("settings.localization.price_unit")),1),p(v,{class:"rounded-full whitespace-wrap","data-tippy-allowHTML":"true","data-tippy-placement":"right",content:e.$t("tooltips.settings.local.price_unit")},{default:y(()=>[p(u,{class:"h-5 ml-1 mt-0.5 tippy-icon"})]),_:1},8,["content"])]),p(D,{modelValue:a.value.price_unit,"onUpdate:modelValue":t[6]||(t[6]=l=>a.value.price_unit=l),options:{placeholder:e.$t("settings.localization.choose_price_unit")},class:"w-full"},{default:y(()=>[(n(!0),i(x,null,w(G.value,(l,d)=>(n(),i("option",{value:l.value,key:d},r(e.$t(`settings.localization.priceOptions.${l.key}`)),9,et))),128))]),_:2},1032,["modelValue","options"])]),o("div",tt,[o("div",at,r(e.$t("settings.localization.decimal_places")),1),p(D,{modelValue:a.value.decimal_places,"onUpdate:modelValue":t[7]||(t[7]=l=>a.value.decimal_places=l),options:{placeholder:e.$t("settings.localization.choose_decimal_places")},class:"w-full"},{default:y(()=>[(n(!0),i(x,null,w(Y.value,(l,d)=>(n(),i("option",{value:l.value,key:d},r(l.text),9,st))),128))]),_:2},1032,["modelValue","options"])])],2)):c=="logistics"?(n(),M(be,{key:2,campaign:a.value,v:m(_),class:h(c)},null,8,["campaign","v","class"])):c=="payments"?(n(),M(xe,{key:3,campaign:a.value,directPaymentImages:C.value,v:m(_),class:h(c)},null,8,["campaign","directPaymentImages","v","class"])):c=="points"?(n(),i("div",{key:4,class:h([c,"box p-5 lg:mx-20 lg:px-40 mt-3 sm:p-8 text-sm sm:text-lg"])},[p(Ie,{meta_point:a.value.meta_point,v:m(_)},null,8,["meta_point","v"])],2)):c=="messages"?(n(),i("div",{key:5,class:h([c,"box p-5 lg:mx-20 lg:px-40 mt-3 sm:p-8 text-sm sm:text-lg"])},[p($e,{meta_reply:a.value.meta_reply,v:m(_)},null,8,["meta_reply","v"])],2)):c=="notes"?(n(),M(we,{key:6,campaignNotes:b.value,class:h(c)},null,8,["campaignNotes","class"])):E("",!0)],64)}),128)),o("div",lt,[o("button",{class:"w-32 bg-white btn dark:border-darkmode-400",onClick:t[8]||(t[8]=c=>e.$router.push({name:"campaign-list"}))},r(e.$t("create_campaign.cancel")),1),o("button",{class:"w-32 ml-5 mr-4 shadow-md btn btn-primary",onClick:t[9]||(t[9]=c=>Z())},r(e.$t("create_campaign.create")),1)])])}}};var ut=te(ot,[["__scopeId","data-v-20abf92e"]]);export{ut as default};
